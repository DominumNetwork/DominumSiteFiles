<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>procksi (enhanced themes)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root {
      /* Default theme (Purple) */
      --bg-primary: #000;
      --bg-secondary: #1a001a;
      --bg-tertiary: #2a0033;
      --bg-quaternary: #3a0044;
      --bg-accent: #4a0055;
      --text-primary: #d0f;
      --text-secondary: #d0f9;
      --border-primary: #d0f;
      --border-secondary: rgba(221, 0, 255, 0.3);
      --border-tertiary: #d0f3;
      --accent-primary: #ff00ff;
      --accent-secondary: #d0f;
      --shadow-primary: rgba(221, 0, 255, 0.5);
      --shadow-secondary: rgba(221, 0, 255, 0.3);
      --shadow-tertiary: rgba(221, 0, 255, 0.2);
      --error-color: #f00;
      --warning-color: #ff0;
      --info-color: #0ff;
      --success-color: #0f0;
      --transition-speed: 0.3s;
    }

    * {
      box-sizing: border-box;
      transition: background-color var(--transition-speed) ease, 
                  color var(--transition-speed) ease, 
                  border-color var(--transition-speed) ease,
                  box-shadow var(--transition-speed) ease;
    }
    
    body {
      margin: 0;
      font-family: monospace;
      display: flex;
      flex-direction: column;
      height: 100vh;
      background: var(--bg-primary);
      color: var(--text-primary);
    }
    
    /* Loading animation */
    @keyframes pulse {
      0% { opacity: 0.6; }
      50% { opacity: 1; }
      100% { opacity: 0.6; }
    }
    
    @keyframes slideInFromTop {
      from {
        transform: translateY(-100%);
        opacity: 0;
      }
      to {
        transform: translateY(0);
        opacity: 1;
      }
    }
    
    @keyframes slideOutToTop {
      from {
        transform: translateY(0);
        opacity: 1;
      }
      to {
        transform: translateY(-100%);
        opacity: 0;
      }
    }
    
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    
    @keyframes fadeOut {
      from { opacity: 1; }
      to { opacity: 0; }
    }
    
    @keyframes slideInFromRight {
      from {
        transform: translateX(100%);
        opacity: 0;
      }
      to {
        transform: translateX(0);
        opacity: 1;
      }
    }
    
    @keyframes slideOutToRight {
      from {
        transform: translateX(0);
        opacity: 1;
      }
      to {
        transform: translateX(100%);
        opacity: 0;
      }
    }
    
    @keyframes scaleIn {
      from {
        transform: scale(0.8);
        opacity: 0;
      }
      to {
        transform: scale(1);
        opacity: 1;
      }
    }
    
    @keyframes scaleOut {
      from {
        transform: scale(1);
        opacity: 1;
      }
      to {
        transform: scale(0.8);
        opacity: 0;
      }
    }
    
    @keyframes buttonPress {
      0% { transform: scale(1); }
      50% { transform: scale(0.95); }
      100% { transform: scale(1); }
    }
    
    @keyframes glow {
      0% { box-shadow: 0 0 5px var(--accent-secondary); }
      50% { box-shadow: 0 0 20px var(--accent-secondary), 0 0 30px var(--accent-secondary); }
      100% { box-shadow: 0 0 5px var(--accent-secondary); }
    }
    
    @keyframes themeTransition {
      0% { transform: scale(1); opacity: 1; }
      50% { transform: scale(0.95); opacity: 0.8; }
      100% { transform: scale(1); opacity: 1; }
    }
    
    #controls {
      padding: 0.5rem 1rem;
      background: var(--bg-secondary);
      display: flex;
      gap: 0.75rem;
      align-items: center;
      animation: slideInFromTop 0.3s ease-out;
    }
    
    input {
      flex: 1;
      background: var(--bg-tertiary);
      color: var(--text-primary);
      font-size: 1rem;
      padding: 0.5rem 0.75rem;
      border: 1px solid var(--border-primary);
      border-radius: 4px;
      transition: all var(--transition-speed) ease;
    }
    
    input:focus {
      outline: none;
      box-shadow: 0 0 10px var(--shadow-primary);
      border-color: var(--accent-primary);
    }
    
    input::placeholder {
      color: var(--text-secondary);
    }
    
    button {
      background: rgba(0,0,0,0);
      color: var(--text-primary);
      border: 1px solid rgba(0,0,0,0);
      padding: 0.5rem 1rem;
      font-size: 1rem;
      border-radius: 4px;
      cursor: pointer;
      transition: all var(--transition-speed) ease;
      position: relative;
      overflow: hidden;
    }
    
    button:hover {
      background: var(--bg-accent);
      transform: translateY(-2px);
      box-shadow: 0 4px 8px var(--shadow-secondary);
    }
    
    button:active {
      animation: buttonPress 0.1s ease;
    }
    
    button:disabled {
      opacity: 0.5;
      cursor: not-allowed;
      transform: none;
    }
    
    #tab-bar {
      display: flex;
      background: var(--bg-secondary);
      border-bottom: 1px solid var(--border-primary);
      overflow-x: auto;
      scrollbar-width: thin;
      scrollbar-color: var(--border-primary) var(--bg-secondary);
      animation: slideInFromTop 0.4s ease-out;
      scroll-behavior: smooth;
    }
    
    #tab-bar::-webkit-scrollbar {
      height: 5px;
    }
    #tab-bar::-webkit-scrollbar-thumb {
      background-color: var(--border-primary);
    }
    #tab-bar::-webkit-scrollbar-track {
      background-color: var(--bg-secondary);
    }
    
    .tab {
      padding: 0.5rem 1rem;
      background: var(--bg-tertiary);
      border: 1px solid rgba(0,0,0,0);
      border-radius: 20% 20% 0% 0%;
      cursor: pointer;
      white-space: nowrap;
      display: flex;
      align-items: center;
      gap: 0.5rem;
      max-width: 200px;
      min-width: 100px;
      transition: all var(--transition-speed) ease;
      transform: translateY(0);
    }
    
    .tab.new {
      animation: slideInFromRight 0.3s ease-out;
    }
    
    .tab.closing {
      animation: slideOutToRight 0.3s ease-in;
    }
    
    .tab.active {
      background: var(--bg-quaternary);
      border: 1px solid var(--border-secondary);
      transform: translateY(-2px);
      box-shadow: 0 2px 10px var(--shadow-secondary);
    }
    
    .tab:hover:not(.active) {
      background: var(--bg-accent);
      transform: translateY(-1px);
    }
    
    .tab-title {
      overflow: hidden;
      text-overflow: ellipsis;
      flex: 1;
      transition: color var(--transition-speed) ease;
    }
    
    .tab-close {
      font-size: 1.2rem;
      line-height: 1;
      padding: 0.2rem;
      border-radius: 50%;
      transition: all var(--transition-speed) ease;
    }
    
    .tab-close:hover {
      color: var(--text-primary);
      background: var(--bg-accent);
      transform: scale(1.1);
    }
    
    #new-tab {
      padding: 0.5rem 1rem;
      background: rgba(42, 0, 51, 0);
      cursor: pointer;
      font-size: 1.2rem;
      border-radius: 100%;
      transition: all var(--transition-speed) ease;
      display: flex;
      align-items: center;
      justify-content: center;
      min-width: 40px;
    }
    
    #new-tab:hover {
      background: var(--bg-tertiary);
      transform: scale(1.1);
      animation: glow 2s infinite;
    }
    
    #content {
      flex: 1;
      display: flex;
      flex-direction: column;
      position: relative;
      overflow: hidden;
    }
    
    .iframe-container {
      flex: 1;
      display: none;
      opacity: 0;
      transition: opacity var(--transition-speed) ease;
    }
    
    .iframe-container.active {
      display: block;
      opacity: 1;
    }
    
    .iframe-container.loading {
      opacity: 0.7;
    }
    
    iframe {
      width: 100%;
      height: 100%;
      border: none;
      background: var(--bg-primary);
      transition: opacity var(--transition-speed) ease;
    }
    
    #devtools {
      height: 0;
      background: var(--bg-secondary);
      border-top: 1px solid var(--border-primary);
      overflow: hidden;
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      display: flex;
      flex-direction: column;
      transform: translateY(100%);
    }
    
    #devtools.open {
      height: 30%;
      transform: translateY(0);
      box-shadow: 0 -4px 20px var(--shadow-tertiary);
    }
    
    #devtools.opening {
      animation: slideInFromTop 0.4s ease-out;
    }
    
    #devtools.closing {
      animation: slideOutToTop 0.4s ease-in;
    }
    
    #devtools-header {
      display: flex;
      justify-content: space-between;
      padding: 0.5rem;
      background: var(--bg-tertiary);
      border-bottom: 1px solid var(--border-primary);
      animation: fadeIn 0.3s ease-out 0.1s both;
    }
    
    #devtools-content {
      display: flex;
      flex: 1;
      overflow: hidden;
      animation: fadeIn 0.3s ease-out 0.2s both;
    }
    
    #devtools-tabs {
      display: flex;
      gap: 0.5rem;
    }
    
    .devtools-tab {
      padding: 0.25rem 0.5rem;
      cursor: pointer;
      transition: all var(--transition-speed) ease;
      border-radius: 4px;
      position: relative;
    }
    
    .devtools-tab:hover {
      background: var(--bg-quaternary);
    }
    
    .devtools-tab.active {
      background: var(--bg-quaternary);
      transform: translateY(-2px);
      box-shadow: 0 2px 8px var(--shadow-secondary);
    }
    
    #devtools-panels {
      flex: 1;
      display: flex;
      overflow: hidden;
      position: relative;
    }
    
    .devtools-panel {
      flex: 1;
      display: none;
      padding: 0.5rem;
      overflow: auto;
      opacity: 0;
      transition: opacity var(--transition-speed) ease;
    }
    
    .devtools-panel.active {
      display: flex;
      flex-direction: column;
      opacity: 1;
      animation: fadeIn 0.3s ease-out;
    }
    
    #console-input {
      width: 100%;
      background: var(--bg-tertiary);
      color: var(--text-primary);
      border: 1px solid var(--border-primary);
      padding: 0.5rem;
      font-family: monospace;
      margin-top: 0.5rem;
      transition: all var(--transition-speed) ease;
    }
    
    #console-input:focus {
      outline: none;
      box-shadow: 0 0 10px var(--shadow-primary);
      border-color: var(--accent-primary);
    }
    
    #console-output {
      flex: 1;
      overflow: auto;
      white-space: pre-wrap;
      padding: 0.5rem;
      background: var(--bg-secondary);
      border: 1px solid var(--border-primary);
      margin-bottom: 0.5rem;
      transition: all var(--transition-speed) ease;
    }
    
    .console-line {
      margin-bottom: 0.25rem;
      border-bottom: 1px solid var(--border-tertiary);
      padding-bottom: 0.25rem;
      opacity: 0;
      animation: fadeIn 0.3s ease-out forwards;
    }
    
    .console-error {
      color: var(--error-color);
    }
    .console-warn {
      color: var(--warning-color);
    }
    .console-info {
      color: var(--info-color);
    }
    
    #js-inject-area {
      width: 100%;
      height: 150px;
      background: var(--bg-tertiary);
      color: var(--text-primary);
      border: 1px solid var(--border-primary);
      padding: 0.5rem;
      font-family: monospace;
      resize: vertical;
      transition: all var(--transition-speed) ease;
    }
    
    #js-inject-area:focus {
      outline: none;
      box-shadow: 0 0 10px var(--shadow-primary);
      border-color: var(--accent-primary);
    }
    
    .action-buttons {
      display: flex;
      gap: 0.5rem;
      margin-top: 0.5rem;
    }
    
    .small-button {
      padding: 0.25rem 0.5rem;
      font-size: 0.9rem;
    }
    
    .status-bar {
      background: var(--bg-secondary);
      padding: 0.25rem 0.5rem;
      font-size: 0.8rem;
      display: flex;
      justify-content: space-between;
      border-top: 1px solid var(--border-primary);
      animation: slideInFromTop 0.5s ease-out;
    }
    
    .status-updating {
      animation: pulse 1s infinite;
    }
    
    select {
      background: var(--bg-tertiary);
      color: var(--text-primary);
      border: 1px solid var(--border-primary);
      padding: 0.25rem 0.5rem;
      font-family: monospace;
      border-radius: 4px;
      transition: all var(--transition-speed) ease;
    }
    
    select:focus {
      outline: none;
      box-shadow: 0 0 10px var(--shadow-primary);
      border-color: var(--accent-primary);
    }
    
    /* Loading overlay */
    .loading-overlay {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.8);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1000;
      opacity: 0;
      visibility: hidden;
      transition: all var(--transition-speed) ease;
    }
    
    .loading-overlay.active {
      opacity: 1;
      visibility: visible;
    }
    
    .loading-spinner {
      width: 40px;
      height: 40px;
      border: 3px solid var(--border-primary);
      border-top: 3px solid transparent;
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }
    
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    
    /* Notification system */
    .notification {
      position: fixed;
      top: 20px;
      right: 20px;
      background: var(--bg-tertiary);
      color: var(--text-primary);
      padding: 0.75rem 1rem;
      border: 1px solid var(--border-primary);
      border-radius: 4px;
      z-index: 1001;
      transform: translateX(100%);
      transition: transform var(--transition-speed) ease;
    }
    
    .notification.show {
      transform: translateX(0);
    }

    /* Themes Panel Styles */
    #themes-panel {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.8);
      backdrop-filter: blur(5px);
      z-index: 2000;
      display: flex;
      align-items: center;
      justify-content: center;
      opacity: 0;
      visibility: hidden;
      transition: all var(--transition-speed) ease;
    }
    
    #themes-panel.active {
      opacity: 1;
      visibility: visible;
    }
    
    .themes-modal {
      background: var(--bg-secondary);
      border: 2px solid var(--border-primary);
      border-radius: 12px;
      padding: 2rem;
      max-width: 1200px;
      width: 95%;
      max-height: 90vh;
      overflow-y: auto;
      transform: scale(0.8);
      transition: all var(--transition-speed) ease;
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.5);
    }
    
    #themes-panel.active .themes-modal {
      transform: scale(1);
    }
    
    .themes-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1rem;
      padding-bottom: 1rem;
      border-bottom: 1px solid var(--border-primary);
    }
    
    .themes-title {
      font-size: 1.5rem;
      font-weight: bold;
      color: var(--text-primary);
    }
    
    .themes-close {
      background: none;
      border: none;
      font-size: 1.5rem;
      color: var(--text-primary);
      cursor: pointer;
      padding: 0.5rem;
      border-radius: 50%;
      transition: all var(--transition-speed) ease;
    }
    
    .themes-close:hover {
      background: var(--bg-accent);
      transform: scale(1.1);
    }
    
    .themes-tabs {
      display: flex;
      gap: 1rem;
      margin-bottom: 2rem;
    }
    
    .themes-tab {
      padding: 0.5rem 1rem;
      background: var(--bg-tertiary);
      color: var(--text-primary);
      border: 1px solid var(--border-primary);
      border-radius: 4px;
      cursor: pointer;
      transition: all var(--transition-speed) ease;
    }
    
    .themes-tab:hover {
      background: var(--bg-accent);
    }
    
    .themes-tab.active {
      background: var(--accent-primary);
      color: var(--bg-primary);
    }
    
    .themes-content {
      display: none;
    }
    
    .themes-content.active {
      display: block;
    }
    
    .themes-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      gap: 1rem;
      margin-bottom: 2rem;
    }
    
    .theme-card {
      background: var(--bg-tertiary);
      border: 2px solid var(--border-primary);
      border-radius: 8px;
      padding: 1rem;
      cursor: pointer;
      transition: all var(--transition-speed) ease;
      position: relative;
      overflow: hidden;
    }
    
    .theme-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 16px var(--shadow-secondary);
      border-color: var(--accent-primary);
    }
    
    .theme-card.active {
      border-color: var(--accent-primary);
      box-shadow: 0 0 20px var(--shadow-primary);
    }
    
    .theme-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: linear-gradient(90deg, var(--accent-primary), var(--accent-secondary));
    }
    
    .theme-name {
      font-size: 1.1rem;
      font-weight: bold;
      margin-bottom: 0.5rem;
      color: var(--text-primary);
    }
    
    .theme-description {
      font-size: 0.9rem;
      color: var(--text-secondary);
      margin-bottom: 1rem;
      line-height: 1.4;
    }
    
    .theme-preview {
      display: flex;
      gap: 0.5rem;
      margin-bottom: 1rem;
    }
    
    .theme-color {
      width: 20px;
      height: 20px;
      border-radius: 50%;
      border: 1px solid var(--border-primary);
      transition: all var(--transition-speed) ease;
    }
    
    .theme-color:hover {
      transform: scale(1.2);
    }
    
    .themes-footer {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding-top: 1rem;
      border-top: 1px solid var(--border-primary);
    }
    
    .themes-info {
      color: var(--text-secondary);
      font-size: 0.9rem;
    }
    
    .themes-actions {
      display: flex;
      gap: 1rem;
    }
    
    .theme-button {
      padding: 0.5rem 1rem;
      border: 1px solid var(--border-primary);
      background: var(--bg-tertiary);
      color: var(--text-primary);
      border-radius: 4px;
      cursor: pointer;
      transition: all var(--transition-speed) ease;
    }
    
    .theme-button:hover {
      background: var(--bg-accent);
      transform: translateY(-1px);
    }
    
    .theme-button.primary {
      background: var(--accent-primary);
      border-color: var(--accent-primary);
    }
    
    .theme-button.primary:hover {
      background: var(--accent-secondary);
    }
    
    /* Custom Theme Editor Styles */
    .custom-theme-editor {
      max-height: 60vh;
      overflow-y: auto;
    }
    
    .color-groups {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 1.5rem;
      margin-bottom: 2rem;
    }
    
    .color-group {
      background: var(--bg-tertiary);
      border: 1px solid var(--border-primary);
      border-radius: 8px;
      padding: 1rem;
    }
    
    .color-group h3 {
      margin: 0 0 1rem 0;
      color: var(--text-primary);
      font-size: 1.1rem;
      border-bottom: 1px solid var(--border-primary);
      padding-bottom: 0.5rem;
    }
    
    .color-control {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      margin-bottom: 0.75rem;
    }
    
    .color-control label {
      flex: 1;
      color: var(--text-primary);
      font-size: 0.9rem;
    }
    
    .color-picker {
      width: 40px;
      height: 32px;
      border: 1px solid var(--border-primary);
      border-radius: 4px;
      cursor: pointer;
      transition: all var(--transition-speed) ease;
    }
    
    .color-picker:hover {
      transform: scale(1.1);
    }
    
    .opacity-slider {
      width: 80px;
      height: 20px;
      background: var(--bg-quaternary);
      border: 1px solid var(--border-primary);
      border-radius: 4px;
      cursor: pointer;
      appearance: none;
      outline: none;
    }
    
    .opacity-slider::-webkit-slider-thumb {
      appearance: none;
      width: 20px;
      height: 20px;
      background: var(--accent-primary);
      border-radius: 50%;
      cursor: pointer;
    }
    
    .opacity-slider::-moz-range-thumb {
      width: 20px;
      height: 20px;
      background: var(--accent-primary);
      border-radius: 50%;
      cursor: pointer;
      border: none;
    }
    
    .color-value {
      font-family: monospace;
      font-size: 0.8rem;
      color: var(--text-secondary);
      min-width: 80px;
    }
    
    .custom-theme-actions {
      display: flex;
      gap: 1rem;
      margin-top: 1rem;
      justify-content: center;
    }
    
    .preset-themes {
      display: flex;
      gap: 0.5rem;
      margin-bottom: 1rem;
      flex-wrap: wrap;
    }
    
    .preset-theme {
      padding: 0.25rem 0.5rem;
      background: var(--bg-quaternary);
      border: 1px solid var(--border-primary);
      border-radius: 4px;
      cursor: pointer;
      font-size: 0.8rem;
      transition: all var(--transition-speed) ease;
    }
    
    .preset-theme:hover {
      background: var(--bg-accent);
    }
    
    /* Theme transition animation */
    body.theme-changing {
      animation: themeTransition 0.5s ease-out;
    }
    
    /* Custom scrollbar for themes panel */
    .themes-modal::-webkit-scrollbar {
      width: 8px;
    }
    
    .themes-modal::-webkit-scrollbar-track {
      background: var(--bg-tertiary);
    }
    
    .themes-modal::-webkit-scrollbar-thumb {
      background: var(--border-primary);
      border-radius: 4px;
    }
    
    .themes-modal::-webkit-scrollbar-thumb:hover {
      background: var(--accent-primary);
    }
    
    .custom-theme-editor::-webkit-scrollbar {
      width: 6px;
    }
    
    .custom-theme-editor::-webkit-scrollbar-track {
      background: var(--bg-quaternary);
    }
    
    .custom-theme-editor::-webkit-scrollbar-thumb {
      background: var(--border-primary);
      border-radius: 3px;
    }
  </style>
</head>
<body>
  <div id="tab-bar">
    <div id="new-tab">+</div>
  </div>
  
  <div id="controls">
    <button id="back-button"><</button>
    <button id="forward-button">></button>
    <button id="refresh-button">↻</button>
    <input id="urlInput" placeholder="Enter URL or search..." />
    <button id="go-button">Go</button>
    <button id="themes-button">🎨</button>
    <button id="toggle-devtools">{ }</button>
  </div>
  
  <div id="content">
    <div class="loading-overlay" id="loading-overlay">
      <div class="loading-spinner"></div>
    </div>
    <!-- Iframe containers will be added here dynamically -->
  </div>
  
  <div id="devtools">
    <div id="devtools-header">
      <div id="devtools-tabs">
        <div class="devtools-tab active" data-panel="console">Console</div>
        <div class="devtools-tab" data-panel="js-inject">JS Inject</div>
        <div class="devtools-tab" data-panel="network">Network</div>
      </div>
      <button id="close-devtools">×</button>
    </div>
    <div id="devtools-panels">
      <div class="devtools-panel active" id="console-panel">
        <div id="console-output"></div>
        <input id="console-input" placeholder="Enter JavaScript to execute in the active tab..." />
      </div>
      <div class="devtools-panel" id="js-inject-panel">
        <textarea id="js-inject-area" placeholder="Enter JavaScript code to inject into the active tab..."></textarea>
        <div class="action-buttons">
          <button id="inject-js-button">Inject JavaScript</button>
          <button id="clear-js-button" class="small-button">Clear</button>
          <button id="save-js-button" class="small-button">Save Snippet</button>
          <select id="saved-snippets">
            <option value="">-- Saved Snippets --</option>
            <option value="document.querySelectorAll('*').forEach(el => el.style.border = '1px solid red')">
              Highlight All Elements
            </option>
            <option value="console.log(document.cookie)">Log Cookies</option>
            <option value="document.body.style.filter = 'invert(100%)'">Invert Colors</option>
          </select>
        </div>
      </div>
      <div class="devtools-panel" id="network-panel">
        <div id="network-log">Network monitoring will appear here...</div>
        <div class="action-buttons">
          <button id="clear-network-log">Clear Log</button>
        </div>
      </div>
    </div>
  </div>
  
  <div class="status-bar">
    <span id="status-text">Ready</span>
    <span id="tab-count">Tabs: 1</span>
  </div>

  <!-- Enhanced Themes Panel -->
  <div id="themes-panel">
    <div class="themes-modal">
      <div class="themes-header">
        <div class="themes-title">🎨 Theme Customization</div>
        <button class="themes-close" id="themes-close">×</button>
      </div>
      
      <div class="themes-tabs">
        <div class="themes-tab active" data-content="preset-themes">Preset Themes</div>
        <div class="themes-tab" data-content="custom-theme">Custom Theme</div>
      </div>
      
      <div class="themes-content active" id="preset-themes">
        <div class="themes-grid" id="themes-grid">
          <!-- Theme cards will be generated here -->
        </div>
      </div>
      
      <div class="themes-content" id="custom-theme">
        <div class="custom-theme-editor">
          <div class="preset-themes" id="preset-buttons">
            <div class="preset-theme" data-theme="purple">Purple</div>
            <div class="preset-theme" data-theme="dracula">Dracula</div>
            <div class="preset-theme" data-theme="solarizedDark">Solarized Dark</div>
            <div class="preset-theme" data-theme="gruvboxDark">Gruvbox Dark</div>
            <div class="preset-theme" data-theme="cyberpunk">Cyberpunk</div>
          </div>
          
          <div class="color-groups" id="color-groups">
            <!-- Color controls will be generated here -->
          </div>
          
          <div class="custom-theme-actions">
            <button class="theme-button" id="save-custom-theme">Save Theme</button>
            <button class="theme-button" id="load-custom-theme">Load Theme</button>
            <button class="theme-button primary" id="apply-custom-theme">Apply Theme</button>
          </div>
        </div>
      </div>
      
      <div class="themes-footer">
        <div class="themes-info">
          Choose a theme to customize your browsing experience
        </div>
        <div class="themes-actions">
          <button class="theme-button" id="reset-theme">Reset to Default</button>
          <button class="theme-button primary" id="apply-theme">Apply Theme</button>
        </div>
      </div>
    </div>
  </div>

  <script>
    // Enhanced theme definitions with way more themes
    const themes = {
      purple: {
        name: "Purple Haze",
        description: "The classic purple theme with magenta accents",
        colors: {
          '--bg-primary': '#000',
          '--bg-secondary': '#1a001a',
          '--bg-tertiary': '#2a0033',
          '--bg-quaternary': '#3a0044',
          '--bg-accent': '#4a0055',
          '--text-primary': '#d0f',
          '--text-secondary': '#d0f9',
          '--border-primary': '#d0f',
          '--border-secondary': 'rgba(221, 0, 255, 0.3)',
          '--border-tertiary': '#d0f3',
          '--accent-primary': '#ff00ff',
          '--accent-secondary': '#d0f',
          '--shadow-primary': 'rgba(221, 0, 255, 0.5)',
          '--shadow-secondary': 'rgba(221, 0, 255, 0.3)',
          '--shadow-tertiary': 'rgba(221, 0, 255, 0.2)',
          '--error-color': '#f00',
          '--warning-color': '#ff0',
          '--info-color': '#0ff',
          '--success-color': '#0f0',
          '--transition-speed': '0.3s'
        },
        preview: ['#d0f', '#ff00ff', '#2a0033', '#4a0055', '#000']
      },
      
      cyberpunk: {
        name: "Cyberpunk 2077",
        description: "Neon-lit future with electric blues and pinks",
        colors: {
          '--bg-primary': '#0a0a0a',
          '--bg-secondary': '#1a1a2e',
          '--bg-tertiary': '#16213e',
          '--bg-quaternary': '#0f3460',
          '--bg-accent': '#533a7b',
          '--text-primary': '#00ffff',
          '--text-secondary': '#00ffff99',
          '--border-primary': '#00ffff',
          '--border-secondary': 'rgba(0, 255, 255, 0.3)',
          '--border-tertiary': '#00ffff33',
          '--accent-primary': '#ff0080',
          '--accent-secondary': '#00ffff',
          '--shadow-primary': 'rgba(0, 255, 255, 0.5)',
          '--shadow-secondary': 'rgba(255, 0, 128, 0.3)',
          '--shadow-tertiary': 'rgba(0, 255, 255, 0.2)',
          '--error-color': '#ff0040',
          '--warning-color': '#ffff00',
          '--info-color': '#00ffff',
          '--success-color': '#00ff80',
          '--transition-speed': '0.3s'
        },
        preview: ['#00ffff', '#ff0080', '#16213e', '#533a7b', '#0a0a0a']
      },
      
      matrix: {
        name: "Matrix Code",
        description: "Digital rain in the machine",
        colors: {
          '--bg-primary': '#000000',
          '--bg-secondary': '#001100',
          '--bg-tertiary': '#002200',
          '--bg-quaternary': '#003300',
          '--bg-accent': '#004400',
          '--text-primary': '#00ff00',
          '--text-secondary': '#00ff0099',
          '--border-primary': '#00ff00',
          '--border-secondary': 'rgba(0, 255, 0, 0.3)',
          '--border-tertiary': '#00ff0033',
          '--accent-primary': '#33ff33',
          '--accent-secondary': '#00ff00',
          '--shadow-primary': 'rgba(0, 255, 0, 0.5)',
          '--shadow-secondary': 'rgba(0, 255, 0, 0.3)',
          '--shadow-tertiary': 'rgba(0, 255, 0, 0.2)',
          '--error-color': '#ff0000',
          '--warning-color': '#ffff00',
          '--info-color': '#00ffff',
          '--success-color': '#00ff00',
          '--transition-speed': '0.3s'
        },
        preview: ['#00ff00', '#33ff33', '#002200', '#004400', '#000000']
      },
      
      dracula: {
        name: "Dracula",
        description: "Classic dark with vampiric purples",
        colors: {
          '--bg-primary': '#0b0d16',
          '--bg-secondary': '#1e2029',
          '--bg-tertiary': '#282a36',
          '--bg-quaternary': '#343746',
          '--bg-accent': '#44475a',
          '--text-primary': '#f8f8f2',
          '--text-secondary': '#f8f8f299',
          '--border-primary': '#bd93f9',
          '--border-secondary': 'rgba(189,147,249,0.3)',
          '--border-tertiary': '#bd93f933',
          '--accent-primary': '#ff79c6',
          '--accent-secondary': '#bd93f9',
          '--shadow-primary': 'rgba(189,147,249,0.5)',
          '--shadow-secondary': 'rgba(255,121,198,0.3)',
          '--shadow-tertiary': 'rgba(189,147,249,0.2)',
          '--error-color': '#ff5555',
          '--warning-color': '#f1fa8c',
          '--info-color': '#8be9fd',
          '--success-color': '#50fa7b',
          '--transition-speed': '0.3s'
        },
        preview: ['#bd93f9', '#ff79c6', '#282a36', '#44475a', '#0b0d16']
      },
      
      solarizedDark: {
        name: "Solarized Dark",
        description: "Low-contrast night surfing",
        colors: {
          '--bg-primary': '#002b36',
          '--bg-secondary': '#073642',
          '--bg-tertiary': '#0d3c4d',
          '--bg-quaternary': '#124657',
          '--bg-accent': '#165060',
          '--text-primary': '#93a1a1',
          '--text-secondary': '#93a1a199',
          '--border-primary': '#268bd2',
          '--border-secondary': 'rgba(38,139,210,0.3)',
          '--border-tertiary': '#268bd233',
          '--accent-primary': '#b58900',
          '--accent-secondary': '#268bd2',
          '--shadow-primary': 'rgba(38,139,210,0.5)',
          '--shadow-secondary': 'rgba(181,137,0,0.3)',
          '--shadow-tertiary': 'rgba(38,139,210,0.2)',
          '--error-color': '#dc322f',
          '--warning-color': '#b58900',
          '--info-color': '#268bd2',
          '--success-color': '#859900',
          '--transition-speed': '0.3s'
        },
        preview: ['#268bd2', '#b58900', '#0d3c4d', '#165060', '#002b36']
      },
      
      solarizedLight: {
        name: "Solarized Light",
        description: "Bright but gentle daytime palette",
        colors: {
          '--bg-primary': '#fdf6e3',
          '--bg-secondary': '#eee8d5',
          '--bg-tertiary': '#e1dbcd',
          '--bg-quaternary': '#d5cfbe',
          '--bg-accent': '#c9c5b1',
          '--text-primary': '#586e75',
          '--text-secondary': '#586e7599',
          '--border-primary': '#2aa198',
          '--border-secondary': 'rgba(42,161,152,0.3)',
          '--border-tertiary': '#2aa19833',
          '--accent-primary': '#cb4b16',
          '--accent-secondary': '#2aa198',
          '--shadow-primary': 'rgba(42,161,152,0.5)',
          '--shadow-secondary': 'rgba(203,75,22,0.3)',
          '--shadow-tertiary': 'rgba(42,161,152,0.2)',
          '--error-color': '#dc322f',
          '--warning-color': '#b58900',
          '--info-color': '#268bd2',
          '--success-color': '#859900',
          '--transition-speed': '0.3s'
        },
        preview: ['#2aa198', '#cb4b16', '#e1dbcd', '#c9c5b1', '#fdf6e3']
      },
      
      gruvboxDark: {
        name: "Gruvbox Dark",
        description: "Comfortable contrast with warm whites",
        colors: {
          '--bg-primary': '#282828',
          '--bg-secondary': '#3c3836',
          '--bg-tertiary': '#504945',
          '--bg-quaternary': '#665c54',
          '--bg-accent': '#7c6f64',
          '--text-primary': '#ebdbb2',
          '--text-secondary': '#ebdbb299',
          '--border-primary': '#fabd2f',
          '--border-secondary': 'rgba(250,189,47,0.3)',
          '--border-tertiary': '#fabd2f33',
          '--accent-primary': '#d79921',
          '--accent-secondary': '#fabd2f',
          '--shadow-primary': 'rgba(250,189,47,0.5)',
          '--shadow-secondary': 'rgba(215,153,33,0.3)',
          '--shadow-tertiary': 'rgba(250,189,47,0.2)',
          '--error-color': '#fb4934',
          '--warning-color': '#fe8019',
          '--info-color': '#83a598',
          '--success-color': '#b8bb26',
          '--transition-speed': '0.3s'
        },
        preview: ['#fabd2f', '#d79921', '#504945', '#7c6f64', '#282828']
      },
      
      gruvboxLight: {
        name: "Gruvbox Light",
        description: "Sunny variation of Gruvbox",
        colors: {
          '--bg-primary': '#fbf1c7',
          '--bg-secondary': '#eee4b5',
          '--bg-tertiary': '#e1d9a3',
          '--bg-quaternary': '#d4ce91',
          '--bg-accent': '#c7c37f',
          '--text-primary': '#3c3836',
          '--text-secondary': '#3c383699',
          '--border-primary': '#cc241d',
          '--border-secondary': 'rgba(204,36,29,0.3)',
          '--border-tertiary': '#cc241d33',
          '--accent-primary': '#d65d0e',
          '--accent-secondary': '#cc241d',
          '--shadow-primary': 'rgba(204,36,29,0.5)',
          '--shadow-secondary': 'rgba(214,93,14,0.3)',
          '--shadow-tertiary': 'rgba(204,36,29,0.2)',
          '--error-color': '#cc241d',
          '--warning-color': '#d79921',
          '--info-color': '#458588',
          '--success-color': '#689d6a',
          '--transition-speed': '0.3s'
        },
        preview: ['#cc241d', '#d65d0e', '#e1d9a3', '#c7c37f', '#fbf1c7']
      },
      
      nord: {
        name: "Nord Frost",
        description: "Icy blues and polar night",
        colors: {
          '--bg-primary': '#2e3440',
          '--bg-secondary': '#3b4252',
          '--bg-tertiary': '#434c5e',
          '--bg-quaternary': '#4c566a',
          '--bg-accent': '#556270',
          '--text-primary': '#d8dee9',
          '--text-secondary': '#d8dee999',
          '--border-primary': '#88c0d0',
          '--border-secondary': 'rgba(136,192,208,0.3)',
          '--border-tertiary': '#88c0d033',
          '--accent-primary': '#81a1c1',
          '--accent-secondary': '#88c0d0',
          '--shadow-primary': 'rgba(136,192,208,0.5)',
          '--shadow-secondary': 'rgba(129,161,193,0.3)',
          '--shadow-tertiary': 'rgba(136,192,208,0.2)',
          '--error-color': '#bf616a',
          '--warning-color': '#ebcb8b',
          '--info-color': '#88c0d0',
          '--success-color': '#a3be8c',
          '--transition-speed': '0.3s'
        },
        preview: ['#88c0d0', '#81a1c1', '#434c5e', '#556270', '#2e3440']
      },
      
      pastelDreams: {
        name: "Pastel Dreams",
        description: "Soft pastels for a soothing look",
        colors: {
          '--bg-primary': '#f8f8ff',
          '--bg-secondary': '#f2f2fc',
          '--bg-tertiary': '#eaeafd',
          '--bg-quaternary': '#e0e0f9',
          '--bg-accent': '#d6d6f5',
          '--text-primary': '#6a6a86',
          '--text-secondary': '#6a6a8699',
          '--border-primary': '#ffb3ba',
          '--border-secondary': 'rgba(255,179,186,0.3)',
          '--border-tertiary': '#ffb3ba33',
          '--accent-primary': '#bae1ff',
          '--accent-secondary': '#ffb3ba',
          '--shadow-primary': 'rgba(255,179,186,0.5)',
          '--shadow-secondary': 'rgba(186,225,255,0.3)',
          '--shadow-tertiary': 'rgba(255,179,186,0.2)',
          '--error-color': '#ff6f69',
          '--warning-color': '#ffcc5c',
          '--info-color': '#bae1ff',
          '--success-color': '#88d8b0',
          '--transition-speed': '0.3s'
        },
        preview: ['#ffb3ba', '#bae1ff', '#eaeafd', '#d6d6f5', '#f8f8ff']
      },
      
      retro80s: {
        name: "Retro 80s",
        description: "Synthwave grid and Miami nights",
        colors: {
          '--bg-primary': '#1a1a2e',
          '--bg-secondary': '#16213e',
          '--bg-tertiary': '#0f3460',
          '--bg-quaternary': '#53354a',
          '--bg-accent': '#a13333',
          '--text-primary': '#e94560',
          '--text-secondary': '#e9456099',
          '--border-primary': '#e94560',
          '--border-secondary': 'rgba(233,69,96,0.3)',
          '--border-tertiary': '#e9456033',
          '--accent-primary': '#ff2e63',
          '--accent-secondary': '#e94560',
          '--shadow-primary': 'rgba(233,69,96,0.5)',
          '--shadow-secondary': 'rgba(255,46,99,0.3)',
          '--shadow-tertiary': 'rgba(233,69,96,0.2)',
          '--error-color': '#c72c41',
          '--warning-color': '#ffb400',
          '--info-color': '#08d9d6',
          '--success-color': '#29ef7b',
          '--transition-speed': '0.3s'
        },
        preview: ['#e94560', '#ff2e63', '#0f3460', '#53354a', '#1a1a2e']
      },
      
      galaxy: {
        name: "Galactic",
        description: "Cosmic purples and starlight blues",
        colors: {
          '--bg-primary': '#0b0316',
          '--bg-secondary': '#130626',
          '--bg-tertiary': '#1b092f',
          '--bg-quaternary': '#220c38',
          '--bg-accent': '#2a0f42',
          '--text-primary': '#9f7aea',
          '--text-secondary': '#9f7aea99',
          '--border-primary': '#805ad5',
          '--border-secondary': 'rgba(128,90,213,0.3)',
          '--border-tertiary': '#805ad533',
          '--accent-primary': '#63b3ed',
          '--accent-secondary': '#805ad5',
          '--shadow-primary': 'rgba(128,90,213,0.5)',
          '--shadow-secondary': 'rgba(99,179,237,0.3)',
          '--shadow-tertiary': 'rgba(128,90,213,0.2)',
          '--error-color': '#ff6a6a',
          '--warning-color': '#f6e05e',
          '--info-color': '#63b3ed',
          '--success-color': '#68d391',
          '--transition-speed': '0.3s'
        },
        preview: ['#805ad5', '#63b3ed', '#1b092f', '#2a0f42', '#0b0316']
      },
      
      candy: {
        name: "Candy Shop",
        description: "Bubblegum, cotton candy & lollipops",
        colors: {
          '--bg-primary': '#22111b',
          '--bg-secondary': '#2d1420',
          '--bg-tertiary': '#381628',
          '--bg-quaternary': '#451830',
          '--bg-accent': '#521a38',
          '--text-primary': '#ff9cee',
          '--text-secondary': '#ff9cee99',
          '--border-primary': '#ff3f8e',
          '--border-secondary': 'rgba(255,63,142,0.3)',
          '--border-tertiary': '#ff3f8e33',
          '--accent-primary': '#fab95b',
          '--accent-secondary': '#ff3f8e',
          '--shadow-primary': 'rgba(255,63,142,0.5)',
          '--shadow-secondary': 'rgba(250,185,91,0.3)',
          '--shadow-tertiary': 'rgba(255,63,142,0.2)',
          '--error-color': '#ff1b6b',
          '--warning-color': '#faff1b',
          '--info-color': '#1bffff',
          '--success-color': '#1bff6b',
          '--transition-speed': '0.3s'
        },
        preview: ['#ff3f8e', '#fab95b', '#381628', '#521a38', '#22111b']
      },
      
      monochrome: {
        name: "Monochrome",
        description: "Fifty shades of gray",
        colors: {
          '--bg-primary': '#111111',
          '--bg-secondary': '#1c1c1c',
          '--bg-tertiary': '#262626',
          '--bg-quaternary': '#303030',
          '--bg-accent': '#3a3a3a',
          '--text-primary': '#dcdcdc',
          '--text-secondary': '#dcdcdc99',
          '--border-primary': '#7f7f7f',
          '--border-secondary': 'rgba(127,127,127,0.3)',
          '--border-tertiary': '#7f7f7f33',
          '--accent-primary': '#bfbfbf',
          '--accent-secondary': '#7f7f7f',
          '--shadow-primary': 'rgba(127,127,127,0.5)',
          '--shadow-secondary': 'rgba(191,191,191,0.3)',
          '--shadow-tertiary': 'rgba(127,127,127,0.2)',
          '--error-color': '#ff5555',
          '--warning-color': '#ffaa00',
          '--info-color': '#55aaff',
          '--success-color': '#55ff55',
          '--transition-speed': '0.3s'
        },
        preview: ['#dcdcdc', '#bfbfbf', '#262626', '#3a3a3a', '#111111']
      },
      
      sunset: {
        name: "Sunset Vibes",
        description: "Warm oranges and deep purples",
        colors: {
          '--bg-primary': '#1a0f1a',
          '--bg-secondary': '#2d1b2d',
          '--bg-tertiary': '#3d2a3d',
          '--bg-quaternary': '#4d3a4d',
          '--bg-accent': '#5d4a5d',
          '--text-primary': '#ff8c42',
          '--text-secondary': '#ff8c4299',
          '--border-primary': '#ff8c42',
          '--border-secondary': 'rgba(255, 140, 66, 0.3)',
          '--border-tertiary': '#ff8c4233',
          '--accent-primary': '#ff6b1a',
          '--accent-secondary': '#ff8c42',
          '--shadow-primary': 'rgba(255, 140, 66, 0.5)',
          '--shadow-secondary': 'rgba(255, 107, 26, 0.3)',
          '--shadow-tertiary': 'rgba(255, 140, 66, 0.2)',
          '--error-color': '#ff4444',
          '--warning-color': '#ffaa00',
          '--info-color': '#42a5f5',
          '--success-color': '#66bb6a',
          '--transition-speed': '0.3s'
        },
        preview: ['#ff8c42', '#ff6b1a', '#3d2a3d', '#5d4a5d', '#1a0f1a']
      },
      
      oceanic: {
        name: "Deep Ocean",
        description: "Mysterious depths with aqua highlights",
        colors: {
          '--bg-primary': '#0d1421',
          '--bg-secondary': '#1e2a3a',
          '--bg-tertiary': '#2d3f4f',
          '--bg-quaternary': '#3d5565',
          '--bg-accent': '#4d6a7a',
          '--text-primary': '#56c7d8',
          '--text-secondary': '#56c7d899',
          '--border-primary': '#56c7d8',
          '--border-secondary': 'rgba(86, 199, 216, 0.3)',
          '--border-tertiary': '#56c7d833',
          '--accent-primary': '#42b9d8',
          '--accent-secondary': '#56c7d8',
          '--shadow-primary': 'rgba(86, 199, 216, 0.5)',
          '--shadow-secondary': 'rgba(66, 185, 216, 0.3)',
          '--shadow-tertiary': 'rgba(86, 199, 216, 0.2)',
          '--error-color': '#ff5555',
          '--warning-color': '#ffb347',
          '--info-color': '#56c7d8',
          '--success-color': '#5cb85c',
          '--transition-speed': '0.3s'
        },
        preview: ['#56c7d8', '#42b9d8', '#2d3f4f', '#4d6a7a', '#0d1421']
      },
      
      forest: {
        name: "Forest Night",
        description: "Natural greens with earthy browns",
        colors: {
          '--bg-primary': '#1a2f1a',
          '--bg-secondary': '#2a3f2a',
          '--bg-tertiary': '#3a4f3a',
          '--bg-quaternary': '#4a5f4a',
          '--bg-accent': '#5a6f5a',
          '--text-primary': '#7fd662',
          '--text-secondary': '#7fd66299',
          '--border-primary': '#7fd662',
          '--border-secondary': 'rgba(127, 214, 98, 0.3)',
          '--border-tertiary': '#7fd66233',
          '--accent-primary': '#6bc442',
          '--accent-secondary': '#7fd662',
          '--shadow-primary': 'rgba(127, 214, 98, 0.5)',
          '--shadow-secondary': 'rgba(107, 196, 66, 0.3)',
          '--shadow-tertiary': 'rgba(127, 214, 98, 0.2)',
          '--error-color': '#e74c3c',
          '--warning-color': '#f39c12',
          '--info-color': '#3498db',
          '--success-color': '#27ae60',
          '--transition-speed': '0.3s'
        },
        preview: ['#7fd662', '#6bc442', '#3a4f3a', '#5a6f5a', '#1a2f1a']
      },
      
      midnight: {
        name: "Midnight Blue",
        description: "Cool midnight tones with silver accents",
        colors: {
          '--bg-primary': '#0f1419',
          '--bg-secondary': '#1f2428',
          '--bg-tertiary': '#2f3438',
          '--bg-quaternary': '#3f4448',
          '--bg-accent': '#4f5458',
          '--text-primary': '#c5c8c6',
          '--text-secondary': '#c5c8c699',
          '--border-primary': '#c5c8c6',
          '--border-secondary': 'rgba(197, 200, 198, 0.3)',
          '--border-tertiary': '#c5c8c633',
          '--accent-primary': '#81a2be',
          '--accent-secondary': '#c5c8c6',
          '--shadow-primary': 'rgba(129, 162, 190, 0.5)',
          '--shadow-secondary': 'rgba(129, 162, 190, 0.3)',
          '--shadow-tertiary': 'rgba(129, 162, 190, 0.2)',
          '--error-color': '#cc6666',
          '--warning-color': '#f0c674',
          '--info-color': '#81a2be',
          '--success-color': '#b5bd68',
          '--transition-speed': '0.3s'
        },
        preview: ['#c5c8c6', '#81a2be', '#2f3438', '#4f5458', '#0f1419']
      },
      
      neon: {
        name: "Neon Nights",
        description: "Electric neon with dark contrasts",
        colors: {
          '--bg-primary': '#000000',
          '--bg-secondary': '#111111',
          '--bg-tertiary': '#222222',
          '--bg-quaternary': '#333333',
          '--bg-accent': '#444444',
          '--text-primary': '#ff073a',
          '--text-secondary': '#ff073a99',
          '--border-primary': '#ff073a',
          '--border-secondary': 'rgba(255, 7, 58, 0.3)',
          '--border-tertiary': '#ff073a33',
          '--accent-primary': '#39ff14',
          '--accent-secondary': '#ff073a',
          '--shadow-primary': 'rgba(255, 7, 58, 0.5)',
          '--shadow-secondary': 'rgba(57, 255, 20, 0.3)',
          '--shadow-tertiary': 'rgba(255, 7, 58, 0.2)',
          '--error-color': '#ff073a',
          '--warning-color': '#ffff00',
          '--info-color': '#00ffff',
          '--success-color': '#39ff14',
          '--transition-speed': '0.3s'
        },
        preview: ['#ff073a', '#39ff14', '#222222', '#444444', '#000000']
      },
      
      sakura: {
        name: "Sakura Blossom",
        description: "Cherry-blossom pinks with dark twigs",
        colors: {
          '--bg-primary': '#251920',
          '--bg-secondary': '#321f2b',
          '--bg-tertiary': '#402635',
          '--bg-quaternary': '#4d2c40',
          '--bg-accent': '#5a334b',
          '--text-primary': '#ffb7c5',
          '--text-secondary': '#ffb7c599',
          '--border-primary': '#ffa3b5',
          '--border-secondary': 'rgba(255,163,181,0.3)',
          '--border-tertiary': '#ffa3b533',
          '--accent-primary': '#ffc1d3',
          '--accent-secondary': '#ffa3b5',
          '--shadow-primary': 'rgba(255,163,181,0.5)',
          '--shadow-secondary': 'rgba(255,193,211,0.3)',
          '--shadow-tertiary': 'rgba(255,163,181,0.2)',
          '--error-color': '#ff6f91',
          '--warning-color': '#ffda77',
          '--info-color': '#ffb7c5',
          '--success-color': '#baffc9',
          '--transition-speed': '0.3s'
        },
        preview: ['#ffa3b5', '#ffc1d3', '#402635', '#5a334b', '#251920']
      },
      
      rainbow: {
        name: "Rainbow Road",
        description: "Taste the spectrum!",
        colors: {
          '--bg-primary': '#0b0b0b',
          '--bg-secondary': '#121212',
          '--bg-tertiary': '#1a1a1a',
          '--bg-quaternary': '#212121',
          '--bg-accent': '#292929',
          '--text-primary': '#ffffff',
          '--text-secondary': '#ffffff99',
          '--border-primary': '#ff0000',
          '--border-secondary': 'rgba(255,0,0,0.3)',
          '--border-tertiary': '#ff000033',
          '--accent-primary': '#ff7f00',
          '--accent-secondary': '#ffff00',
          '--shadow-primary': 'rgba(0,255,0,0.5)',
          '--shadow-secondary': 'rgba(0,0,255,0.3)',
          '--shadow-tertiary': 'rgba(75,0,130,0.2)',
          '--error-color': '#ff0000',
          '--warning-color': '#ff7f00',
          '--info-color': '#0000ff',
          '--success-color': '#00ff00',
          '--transition-speed': '0.3s'
        },
        preview: ['#ff0000', '#ffa500', '#ffff00', '#00ff00', '#0000ff']
      },
      
      highContrast: {
        name: "High Contrast",
        description: "Accessibility first – vibrant on black",
        colors: {
          '--bg-primary': '#000000',
          '--bg-secondary': '#0d0d0d',
          '--bg-tertiary': '#1a1a1a',
          '--bg-quaternary': '#262626',
          '--bg-accent': '#333333',
          '--text-primary': '#ffffff',
          '--text-secondary': '#ffffff99',
          '--border-primary': '#ffffff',
          '--border-secondary': 'rgba(255,255,255,0.3)',
          '--border-tertiary': '#ffffff33',
          '--accent-primary': '#ffff00',
          '--accent-secondary': '#ffffff',
          '--shadow-primary': 'rgba(255,255,255,0.5)',
          '--shadow-secondary': 'rgba(255,255,0,0.3)',
          '--shadow-tertiary': 'rgba(255,255,255,0.2)',
          '--error-color': '#ff0000',
          '--warning-color': '#ffae42',
          '--info-color': '#00ffff',
          '--success-color': '#00ff00',
          '--transition-speed': '0.3s'
        },
        preview: ['#ffffff', '#ffff00', '#1a1a1a', '#333333', '#000000']
      }
    };

    // Color property metadata for custom theme editor
    const colorProperties = {
      'Backgrounds': {
        '--bg-primary': { label: 'Primary Background', type: 'color' },
        '--bg-secondary': { label: 'Secondary Background', type: 'color' },
        '--bg-tertiary': { label: 'Tertiary Background', type: 'color' },
        '--bg-quaternary': { label: 'Quaternary Background', type: 'color' },
        '--bg-accent': { label: 'Accent Background', type: 'color' }
      },
      'Text': {
        '--text-primary': { label: 'Primary Text', type: 'color' },
        '--text-secondary': { label: 'Secondary Text', type: 'color' }
      },
      'Borders': {
        '--border-primary': { label: 'Primary Border', type: 'color' },
        '--border-secondary': { label: 'Secondary Border', type: 'rgba' },
        '--border-tertiary': { label: 'Tertiary Border', type: 'rgba' }
      },
      'Accents': {
        '--accent-primary': { label: 'Primary Accent', type: 'color' },
        '--accent-secondary': { label: 'Secondary Accent', type: 'color' }
      },
      'Shadows': {
        '--shadow-primary': { label: 'Primary Shadow', type: 'rgba' },
        '--shadow-secondary': { label: 'Secondary Shadow', type: 'rgba' },
        '--shadow-tertiary': { label: 'Tertiary Shadow', type: 'rgba' }
      },
      'Status': {
        '--error-color': { label: 'Error Color', type: 'color' },
        '--warning-color': { label: 'Warning Color', type: 'color' },
        '--info-color': { label: 'Info Color', type: 'color' },
        '--success-color': { label: 'Success Color', type: 'color' }
      },
      'Animation': {
        '--transition-speed': { label: 'Transition Speed', type: 'time' }
      }
    };

    let currentTheme = 'purple';
    let selectedTheme = 'purple';
    let customTheme = { ...themes.purple.colors };
    let currentThemeTab = 'preset-themes';

    const proxyBase = "https://api.allorigins.win/raw?url=";
    const tabs = [];
    let activeTabId = null;
    let tabCounter = 0;
    
    // Theme functions
    function loadTheme() {
      const savedTheme = localStorage.getItem('procksiTheme');
      if (savedTheme && themes[savedTheme]) {
        currentTheme = savedTheme;
        selectedTheme = savedTheme;
        applyTheme(savedTheme);
      } else {
        // Try to load custom theme
        const savedCustomTheme = localStorage.getItem('procksiCustomTheme');
        if (savedCustomTheme) {
          try {
            const parsedCustomTheme = JSON.parse(savedCustomTheme);
            customTheme = parsedCustomTheme;
            applyCustomTheme(parsedCustomTheme);
            currentTheme = 'custom';
            selectedTheme = 'custom';
          } catch (e) {
            console.error('Error loading custom theme:', e);
          }
        }
      }
    }
    
    function applyTheme(themeId) {
      const theme = themes[themeId];
      if (!theme) return;
      
      // Add theme changing animation
      document.body.classList.add('theme-changing');
      
      // Apply CSS variables
      const root = document.documentElement;
      Object.entries(theme.colors).forEach(([property, value]) => {
        root.style.setProperty(property, value);
      });
      
      // Update title
      document.title = `procksi (${theme.name})`;
      
      // Save to localStorage
      localStorage.setItem('procksiTheme', themeId);
      localStorage.removeItem('procksiCustomTheme'); // Remove custom theme
      currentTheme = themeId;
      
      // Remove animation class
      setTimeout(() => {
        document.body.classList.remove('theme-changing');
      }, 500);
      
      showNotification(`Theme changed to ${theme.name}`);
    }
    
    function applyCustomTheme(colors) {
      // Add theme changing animation
      document.body.classList.add('theme-changing');
      
      // Apply CSS variables
      const root = document.documentElement;
      Object.entries(colors).forEach(([property, value]) => {
        root.style.setProperty(property, value);
      });
      
      // Update title
      document.title = `procksi (Custom Theme)`;
      
      // Save to localStorage
      localStorage.setItem('procksiCustomTheme', JSON.stringify(colors));
      localStorage.removeItem('procksiTheme'); // Remove preset theme
      currentTheme = 'custom';
      
      // Remove animation class
      setTimeout(() => {
        document.body.classList.remove('theme-changing');
      }, 500);
      
      showNotification('Custom theme applied');
    }
    
    function generateThemeCards() {
      const grid = document.getElementById('themes-grid');
      grid.innerHTML = '';
      
      Object.entries(themes).forEach(([id, theme]) => {
        const card = document.createElement('div');
        card.className = 'theme-card';
        card.dataset.themeId = id;
        
        if (id === currentTheme) {
          card.classList.add('active');
        }
        
        card.innerHTML = `
          <div class="theme-name">${theme.name}</div>
          <div class="theme-description">${theme.description}</div>
          <div class="theme-preview">
            ${theme.preview.map(color => `<div class="theme-color" style="background-color: ${color}"></div>`).join('')}
          </div>
        `;
        
        card.addEventListener('click', () => {
          // Remove active class from all cards
          document.querySelectorAll('.theme-card').forEach(c => c.classList.remove('active'));
          
          // Add active class to clicked card
          card.classList.add('active');
          selectedTheme = id;
          
          // Preview the theme
          previewTheme(id);
        });
        
        grid.appendChild(card);
      });
    }
    
    function previewTheme(themeId) {
      const theme = themes[themeId];
      if (!theme) return;
      
      // Apply theme temporarily for preview
      const root = document.documentElement;
      Object.entries(theme.colors).forEach(([property, value]) => {
        root.style.setProperty(property, value);
      });
    }
    
    function hexToRgb(hex) {
      const result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
      return result ? {
        r: parseInt(result[1], 16),
        g: parseInt(result[2], 16),
        b: parseInt(result[3], 16)
      } : null;
    }
    
    function rgbToHex(r, g, b) {
      return "#" + ((1 << 24) + (r << 16) + (g << 8) + b).toString(16).slice(1);
    }
    
    function parseRgbaValue(value) {
      if (value.startsWith('rgba(')) {
        const match = value.match(/rgba\((\d+),\s*(\d+),\s*(\d+),\s*([0-9.]+)\)/);
        if (match) {
          return {
            r: parseInt(match[1]),
            g: parseInt(match[2]),
            b: parseInt(match[3]),
            a: parseFloat(match[4])
          };
        }
      }
      return null;
    }
    
    function generateColorControls() {
      const container = document.getElementById('color-groups');
      container.innerHTML = '';
      
      Object.entries(colorProperties).forEach(([groupName, properties]) => {
        const group = document.createElement('div');
        group.className = 'color-group';
        group.innerHTML = `<h3>${groupName}</h3>`;
        
        Object.entries(properties).forEach(([property, config]) => {
          const control = document.createElement('div');
          control.className = 'color-control';
          
          const currentValue = customTheme[property] || themes.purple.colors[property];
          
          if (config.type === 'color') {
            control.innerHTML = `
              <label>${config.label}</label>
              <input type="color" class="color-picker" data-property="${property}" value="${currentValue}">
              <span class="color-value">${currentValue}</span>
            `;
          } else if (config.type === 'rgba') {
            const rgba = parseRgbaValue(currentValue);
            const hexColor = rgba ? rgbToHex(rgba.r, rgba.g, rgba.b) : '#000000';
            const opacity = rgba ? rgba.a : 1;
            
            control.innerHTML = `
              <label>${config.label}</label>
              <input type="color" class="color-picker" data-property="${property}" value="${hexColor}">
              <input type="range" class="opacity-slider" data-property="${property}" min="0" max="1" step="0.1" value="${opacity}">
              <span class="color-value">${currentValue}</span>
            `;
          } else if (config.type === 'time') {
            control.innerHTML = `
              <label>${config.label}</label>
              <input type="range" class="time-slider" data-property="${property}" min="0.1" max="2" step="0.1" value="${parseFloat(currentValue)}">
              <span class="color-value">${currentValue}</span>
            `;
          }
          
          group.appendChild(control);
        });
        
        container.appendChild(group);
      });
      
      // Add event listeners for color controls
      setupColorControlListeners();
    }
    
    function setupColorControlListeners() {
      document.querySelectorAll('.color-picker').forEach(picker => {
        picker.addEventListener('input', (e) => {
          const property = e.target.dataset.property;
          const value = e.target.value;
          
          // Check if this property should be rgba
          const config = Object.values(colorProperties).find(group => group[property])?.property;
          const propertyConfig = Object.values(colorProperties).flatMap(group => Object.entries(group)).find(([prop]) => prop === property)?.[1];
          
          if (propertyConfig && propertyConfig.type === 'rgba') {
            const opacitySlider = e.target.parentElement.querySelector('.opacity-slider');
            const opacity = opacitySlider ? opacitySlider.value : '1';
            const rgb = hexToRgb(value);
            if (rgb) {
              const newValue = `rgba(${rgb.r}, ${rgb.g}, ${rgb.b}, ${opacity})`;
              customTheme[property] = newValue;
              e.target.parentElement.querySelector('.color-value').textContent = newValue;
            }
          } else {
            customTheme[property] = value;
            e.target.parentElement.querySelector('.color-value').textContent = value;
          }
          
          // Apply live preview
          document.documentElement.style.setProperty(property, customTheme[property]);
        });
      });
      
      document.querySelectorAll('.opacity-slider').forEach(slider => {
        slider.addEventListener('input', (e) => {
          const property = e.target.dataset.property;
          const opacity = e.target.value;
          const colorPicker = e.target.parentElement.querySelector('.color-picker');
          const rgb = hexToRgb(colorPicker.value);
          
          if (rgb) {
            const newValue = `rgba(${rgb.r}, ${rgb.g}, ${rgb.b}, ${opacity})`;
            customTheme[property] = newValue;
            e.target.parentElement.querySelector('.color-value').textContent = newValue;
            
            // Apply live preview
            document.documentElement.style.setProperty(property, newValue);
          }
        });
      });
      
      document.querySelectorAll('.time-slider').forEach(slider => {
        slider.addEventListener('input', (e) => {
          const property = e.target.dataset.property;
          const value = `${e.target.value}s`;
          customTheme[property] = value;
          e.target.parentElement.querySelector('.color-value').textContent = value;
          
          // Apply live preview
          document.documentElement.style.setProperty(property, value);
        });
      });
    }
    
    function loadPresetIntoCustomEditor(themeId) {
      const theme = themes[themeId];
      if (!theme) return;
      
      customTheme = { ...theme.colors };
      generateColorControls();
      
      // Apply the theme for preview
      Object.entries(customTheme).forEach(([property, value]) => {
        document.documentElement.style.setProperty(property, value);
      });
      
      showNotification(`Loaded ${theme.name} into custom editor`);
    }
    
    function openThemesPanel() {
      generateThemeCards();
      generateColorControls();
      document.getElementById('themes-panel').classList.add('active');
      selectedTheme = currentTheme;
    }
    
    function closeThemesPanel() {
      document.getElementById('themes-panel').classList.remove('active');
      
      // Restore current theme if user didn't apply
      if (currentTheme !== 'custom') {
        if (selectedTheme !== currentTheme) {
          applyTheme(currentTheme);
        }
      } else {
        // Restore custom theme
        applyCustomTheme(customTheme);
      }
    }
    
    function resetTheme() {
      selectedTheme = 'purple';
      applyTheme('purple');
      
      // Update active card
      document.querySelectorAll('.theme-card').forEach(c => c.classList.remove('active'));
      const purpleCard = document.querySelector('.theme-card[data-theme-id="purple"]');
      if (purpleCard) purpleCard.classList.add('active');
    }
    
    function applySelectedTheme() {
      if (selectedTheme !== currentTheme) {
        applyTheme(selectedTheme);
      }
      closeThemesPanel();
    }
    
    function switchThemeTab(tabName) {
      currentThemeTab = tabName;
      
      // Update tab buttons
      document.querySelectorAll('.themes-tab').forEach(tab => {
        tab.classList.remove('active');
      });
      document.querySelector(`[data-content="${tabName}"]`).classList.add('active');
      
      // Update content
      document.querySelectorAll('.themes-content').forEach(content => {
        content.classList.remove('active');
      });
      document.getElementById(tabName).classList.add('active');
    }
    
    // Animation helper functions
    function showLoadingOverlay() {
      document.getElementById('loading-overlay').classList.add('active');
    }
    
    function hideLoadingOverlay() {
      document.getElementById('loading-overlay').classList.remove('active');
    }
    
    function showNotification(message, duration = 3000) {
      const notification = document.createElement('div');
      notification.className = 'notification';
      notification.textContent = message;
      document.body.appendChild(notification);
      
      setTimeout(() => notification.classList.add('show'), 100);
      setTimeout(() => {
        notification.classList.remove('show');
        setTimeout(() => notification.remove(), 300);
      }, duration);
    }
    
    function addStatusAnimation() {
      const statusText = document.getElementById('status-text');
      statusText.classList.add('status-updating');
      setTimeout(() => statusText.classList.remove('status-updating'), 1000);
    }
    
    // Initialize the browser with one tab
    document.addEventListener('DOMContentLoaded', () => {
      // Load saved theme
      loadTheme();
      
      createNewTab();
      
      // Set up event listeners
      document.getElementById('new-tab').addEventListener('click', () => createNewTab());
      document.getElementById('go-button').addEventListener('click', loadPageInActiveTab);
      document.getElementById('toggle-devtools').addEventListener('click', toggleDevTools);
      document.getElementById('close-devtools').addEventListener('click', closeDevTools);
      document.getElementById('console-input').addEventListener('keydown', handleConsoleInput);
      document.getElementById('inject-js-button').addEventListener('click', injectJavaScript);
      document.getElementById('clear-js-button').addEventListener('click', () => {
        document.getElementById('js-inject-area').value = '';
        showNotification('JavaScript area cleared');
      });
      document.getElementById('save-js-button').addEventListener('click', saveJavaScriptSnippet);
      document.getElementById('saved-snippets').addEventListener('change', loadSavedSnippet);
      document.getElementById('clear-network-log').addEventListener('click', () => {
        document.getElementById('network-log').innerHTML = 'Network log cleared...';
        showNotification('Network log cleared');
      });
      document.getElementById('back-button').addEventListener('click', navigateBack);
      document.getElementById('forward-button').addEventListener('click', navigateForward);
      document.getElementById('refresh-button').addEventListener('click', refreshPage);
      
      // Themes panel event listeners
      document.getElementById('themes-button').addEventListener('click', openThemesPanel);
      document.getElementById('themes-close').addEventListener('click', closeThemesPanel);
      document.getElementById('reset-theme').addEventListener('click', resetTheme);
      document.getElementById('apply-theme').addEventListener('click', applySelectedTheme);
      
      // Theme tabs
      document.querySelectorAll('.themes-tab').forEach(tab => {
        tab.addEventListener('click', (e) => {
          const contentId = e.target.dataset.content;
          switchThemeTab(contentId);
        });
      });
      
      // Custom theme editor buttons
      document.getElementById('save-custom-theme').addEventListener('click', () => {
        const name = prompt('Enter a name for your custom theme:');
        if (name) {
          localStorage.setItem(`procksiCustomTheme_${name}`, JSON.stringify(customTheme));
          showNotification(`Custom theme "${name}" saved`);
        }
      });
      
      document.getElementById('load-custom-theme').addEventListener('click', () => {
        const name = prompt('Enter the name of the custom theme to load:');
        if (name) {
          const savedTheme = localStorage.getItem(`procksiCustomTheme_${name}`);
          if (savedTheme) {
            try {
              customTheme = JSON.parse(savedTheme);
              generateColorControls();
              showNotification(`Custom theme "${name}" loaded`);
            } catch (e) {
              showNotification(`Error loading theme "${name}"`);
            }
          } else {
            showNotification(`Theme "${name}" not found`);
          }
        }
      });
      
      document.getElementById('apply-custom-theme').addEventListener('click', () => {
        applyCustomTheme(customTheme);
        closeThemesPanel();
      });
      
      // Preset theme buttons in custom editor
      document.getElementById('preset-buttons').addEventListener('click', (e) => {
        if (e.target.dataset.theme) {
          loadPresetIntoCustomEditor(e.target.dataset.theme);
        }
      });
      
      // Close themes panel on backdrop click
      document.getElementById('themes-panel').addEventListener('click', (e) => {
        if (e.target.id === 'themes-panel') {
          closeThemesPanel();
        }
      });
      
      // Escape key to close themes panel
      document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape' && document.getElementById('themes-panel').classList.contains('active')) {
          closeThemesPanel();
        }
      });
      
      // Set up devtools tabs
      document.querySelectorAll('.devtools-tab').forEach(tab => {
        tab.addEventListener('click', (e) => {
          document.querySelectorAll('.devtools-tab').forEach(t => t.classList.remove('active'));
          document.querySelectorAll('.devtools-panel').forEach(p => p.classList.remove('active'));
          
          e.target.classList.add('active');
          const panelId = e.target.dataset.panel;
          document.getElementById(`${panelId}-panel`).classList.add('active');
        });
      });
      
      // Load saved snippets from localStorage
      loadSavedSnippetsFromStorage();
    });
  </script>
</body>
</html>