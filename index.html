<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>procksi (purple mode)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root {
      /* Default theme (Purple) */
      --bg-primary: #000;
      --bg-secondary: #1a001a;
      --bg-tertiary: #2a0033;
      --bg-quaternary: #3a0044;
      --bg-accent: #4a0055;
      --text-primary: #d0f;
      --text-secondary: #d0f9;
      --border-primary: #d0f;
      --border-secondary: rgba(221, 0, 255, 0.3);
      --border-tertiary: #d0f3;
      --accent-primary: #ff00ff;
      --accent-secondary: #d0f;
      --shadow-primary: rgba(221, 0, 255, 0.5);
      --shadow-secondary: rgba(221, 0, 255, 0.3);
      --shadow-tertiary: rgba(221, 0, 255, 0.2);
      --error-color: #f00;
      --warning-color: #ff0;
      --info-color: #0ff;
      --success-color: #0f0;
      --transition-speed: 0.3s;
    }

    * {
      box-sizing: border-box;
      transition: background-color var(--transition-speed) ease, 
                  color var(--transition-speed) ease, 
                  border-color var(--transition-speed) ease,
                  box-shadow var(--transition-speed) ease;
    }
    
    body {
      margin: 0;
      font-family: monospace;
      display: flex;
      flex-direction: column;
      height: 100vh;
      background: var(--bg-primary);
      color: var(--text-primary);
    }
    
    /* Loading animation */
    @keyframes pulse {
      0% { opacity: 0.6; }
      50% { opacity: 1; }
      100% { opacity: 0.6; }
    }
    
    @keyframes slideInFromTop {
      from {
        transform: translateY(-100%);
        opacity: 0;
      }
      to {
        transform: translateY(0);
        opacity: 1;
      }
    }
    
    @keyframes slideOutToTop {
      from {
        transform: translateY(0);
        opacity: 1;
      }
      to {
        transform: translateY(-100%);
        opacity: 0;
      }
    }
    
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    
    @keyframes fadeOut {
      from { opacity: 1; }
      to { opacity: 0; }
    }
    
    @keyframes slideInFromRight {
      from {
        transform: translateX(100%);
        opacity: 0;
      }
      to {
        transform: translateX(0);
        opacity: 1;
      }
    }
    
    @keyframes slideOutToRight {
      from {
        transform: translateX(0);
        opacity: 1;
      }
      to {
        transform: translateX(100%);
        opacity: 0;
      }
    }
    
    @keyframes scaleIn {
      from {
        transform: scale(0.8);
        opacity: 0;
      }
      to {
        transform: scale(1);
        opacity: 1;
      }
    }
    
    @keyframes scaleOut {
      from {
        transform: scale(1);
        opacity: 1;
      }
      to {
        transform: scale(0.8);
        opacity: 0;
      }
    }
    
    @keyframes buttonPress {
      0% { transform: scale(1); }
      50% { transform: scale(0.95); }
      100% { transform: scale(1); }
    }
    
    @keyframes glow {
      0% { box-shadow: 0 0 5px var(--accent-secondary); }
      50% { box-shadow: 0 0 20px var(--accent-secondary), 0 0 30px var(--accent-secondary); }
      100% { box-shadow: 0 0 5px var(--accent-secondary); }
    }
    
    @keyframes themeTransition {
      0% { transform: scale(1); opacity: 1; }
      50% { transform: scale(0.95); opacity: 0.8; }
      100% { transform: scale(1); opacity: 1; }
    }
    
    #controls {
      padding: 0.5rem 1rem;
      background: var(--bg-secondary);
      display: flex;
      gap: 0.75rem;
      align-items: center;
      animation: slideInFromTop 0.3s ease-out;
    }
    
    input {
      flex: 1;
      background: var(--bg-tertiary);
      color: var(--text-primary);
      font-size: 1rem;
      padding: 0.5rem 0.75rem;
      border: 1px solid var(--border-primary);
      border-radius: 4px;
      transition: all var(--transition-speed) ease;
    }
    
    input:focus {
      outline: none;
      box-shadow: 0 0 10px var(--shadow-primary);
      border-color: var(--accent-primary);
    }
    
    input::placeholder {
      color: var(--text-secondary);
    }
    
    button {
      background: rgba(0,0,0,0);
      color: var(--text-primary);
      border: 1px solid rgba(0,0,0,0);
      padding: 0.5rem 1rem;
      font-size: 1rem;
      border-radius: 4px;
      cursor: pointer;
      transition: all var(--transition-speed) ease;
      position: relative;
      overflow: hidden;
    }
    
    button:hover {
      background: var(--bg-accent);
      transform: translateY(-2px);
      box-shadow: 0 4px 8px var(--shadow-secondary);
    }
    
    button:active {
      animation: buttonPress 0.1s ease;
    }
    
    button:disabled {
      opacity: 0.5;
      cursor: not-allowed;
      transform: none;
    }
    
    #tab-bar {
      display: flex;
      background: var(--bg-secondary);
      border-bottom: 1px solid var(--border-primary);
      overflow-x: auto;
      scrollbar-width: thin;
      scrollbar-color: var(--border-primary) var(--bg-secondary);
      animation: slideInFromTop 0.4s ease-out;
      scroll-behavior: smooth;
    }
    
    #tab-bar::-webkit-scrollbar {
      height: 5px;
    }
    #tab-bar::-webkit-scrollbar-thumb {
      background-color: var(--border-primary);
    }
    #tab-bar::-webkit-scrollbar-track {
      background-color: var(--bg-secondary);
    }
    
    .tab {
      padding: 0.5rem 1rem;
      background: var(--bg-tertiary);
      border: 1px solid rgba(0,0,0,0);
      border-radius: 20% 20% 0% 0%;
      cursor: pointer;
      white-space: nowrap;
      display: flex;
      align-items: center;
      gap: 0.5rem;
      max-width: 200px;
      min-width: 100px;
      transition: all var(--transition-speed) ease;
      transform: translateY(0);
    }
    
    .tab.new {
      animation: slideInFromRight 0.3s ease-out;
    }
    
    .tab.closing {
      animation: slideOutToRight 0.3s ease-in;
    }
    
    .tab.active {
      background: var(--bg-quaternary);
      border: 1px solid var(--border-secondary);
      transform: translateY(-2px);
      box-shadow: 0 2px 10px var(--shadow-secondary);
    }
    
    .tab:hover:not(.active) {
      background: var(--bg-accent);
      transform: translateY(-1px);
    }
    
    .tab-title {
      overflow: hidden;
      text-overflow: ellipsis;
      flex: 1;
      transition: color var(--transition-speed) ease;
    }
    
    .tab-close {
      font-size: 1.2rem;
      line-height: 1;
      padding: 0.2rem;
      border-radius: 50%;
      transition: all var(--transition-speed) ease;
    }
    
    .tab-close:hover {
      color: var(--text-primary);
      background: var(--bg-accent);
      transform: scale(1.1);
    }
    
    #new-tab {
      padding: 0.5rem 1rem;
      background: rgba(42, 0, 51, 0);
      cursor: pointer;
      font-size: 1.2rem;
      border-radius: 100%;
      transition: all var(--transition-speed) ease;
      display: flex;
      align-items: center;
      justify-content: center;
      min-width: 40px;
    }
    
    #new-tab:hover {
      background: var(--bg-tertiary);
      transform: scale(1.1);
      animation: glow 2s infinite;
    }
    
    #content {
      flex: 1;
      display: flex;
      flex-direction: column;
      position: relative;
      overflow: hidden;
    }
    
    .iframe-container {
      flex: 1;
      display: none;
      opacity: 0;
      transition: opacity var(--transition-speed) ease;
    }
    
    .iframe-container.active {
      display: block;
      opacity: 1;
    }
    
    .iframe-container.loading {
      opacity: 0.7;
    }
    
    iframe {
      width: 100%;
      height: 100%;
      border: none;
      background: var(--bg-primary);
      transition: opacity var(--transition-speed) ease;
    }
    
    #devtools {
      height: 0;
      background: var(--bg-secondary);
      border-top: 1px solid var(--border-primary);
      overflow: hidden;
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      display: flex;
      flex-direction: column;
      transform: translateY(100%);
    }
    
    #devtools.open {
      height: 30%;
      transform: translateY(0);
      box-shadow: 0 -4px 20px var(--shadow-tertiary);
    }
    
    #devtools.opening {
      animation: slideInFromTop 0.4s ease-out;
    }
    
    #devtools.closing {
      animation: slideOutToTop 0.4s ease-in;
    }
    
    #devtools-header {
      display: flex;
      justify-content: space-between;
      padding: 0.5rem;
      background: var(--bg-tertiary);
      border-bottom: 1px solid var(--border-primary);
      animation: fadeIn 0.3s ease-out 0.1s both;
    }
    
    #devtools-content {
      display: flex;
      flex: 1;
      overflow: hidden;
      animation: fadeIn 0.3s ease-out 0.2s both;
    }
    
    #devtools-tabs {
      display: flex;
      gap: 0.5rem;
    }
    
    .devtools-tab {
      padding: 0.25rem 0.5rem;
      cursor: pointer;
      transition: all var(--transition-speed) ease;
      border-radius: 4px;
      position: relative;
    }
    
    .devtools-tab:hover {
      background: var(--bg-quaternary);
    }
    
    .devtools-tab.active {
      background: var(--bg-quaternary);
      transform: translateY(-2px);
      box-shadow: 0 2px 8px var(--shadow-secondary);
    }
    
    #devtools-panels {
      flex: 1;
      display: flex;
      overflow: hidden;
      position: relative;
    }
    
    .devtools-panel {
      flex: 1;
      display: none;
      padding: 0.5rem;
      overflow: auto;
      opacity: 0;
      transition: opacity var(--transition-speed) ease;
    }
    
    .devtools-panel.active {
      display: flex;
      flex-direction: column;
      opacity: 1;
      animation: fadeIn 0.3s ease-out;
    }
    
    #console-input {
      width: 100%;
      background: var(--bg-tertiary);
      color: var(--text-primary);
      border: 1px solid var(--border-primary);
      padding: 0.5rem;
      font-family: monospace;
      margin-top: 0.5rem;
      transition: all var(--transition-speed) ease;
    }
    
    #console-input:focus {
      outline: none;
      box-shadow: 0 0 10px var(--shadow-primary);
      border-color: var(--accent-primary);
    }
    
    #console-output {
      flex: 1;
      overflow: auto;
      white-space: pre-wrap;
      padding: 0.5rem;
      background: var(--bg-secondary);
      border: 1px solid var(--border-primary);
      margin-bottom: 0.5rem;
      transition: all var(--transition-speed) ease;
    }
    
    .console-line {
      margin-bottom: 0.25rem;
      border-bottom: 1px solid var(--border-tertiary);
      padding-bottom: 0.25rem;
      opacity: 0;
      animation: fadeIn 0.3s ease-out forwards;
    }
    
    .console-error {
      color: var(--error-color);
    }
    .console-warn {
      color: var(--warning-color);
    }
    .console-info {
      color: var(--info-color);
    }
    
    #js-inject-area {
      width: 100%;
      height: 150px;
      background: var(--bg-tertiary);
      color: var(--text-primary);
      border: 1px solid var(--border-primary);
      padding: 0.5rem;
      font-family: monospace;
      resize: vertical;
      transition: all var(--transition-speed) ease;
    }
    
    #js-inject-area:focus {
      outline: none;
      box-shadow: 0 0 10px var(--shadow-primary);
      border-color: var(--accent-primary);
    }
    
    .action-buttons {
      display: flex;
      gap: 0.5rem;
      margin-top: 0.5rem;
    }
    
    .small-button {
      padding: 0.25rem 0.5rem;
      font-size: 0.9rem;
    }
    
    .status-bar {
      background: var(--bg-secondary);
      padding: 0.25rem 0.5rem;
      font-size: 0.8rem;
      display: flex;
      justify-content: space-between;
      border-top: 1px solid var(--border-primary);
      animation: slideInFromTop 0.5s ease-out;
    }
    
    .status-updating {
      animation: pulse 1s infinite;
    }
    
    select {
      background: var(--bg-tertiary);
      color: var(--text-primary);
      border: 1px solid var(--border-primary);
      padding: 0.25rem 0.5rem;
      font-family: monospace;
      border-radius: 4px;
      transition: all var(--transition-speed) ease;
    }
    
    select:focus {
      outline: none;
      box-shadow: 0 0 10px var(--shadow-primary);
      border-color: var(--accent-primary);
    }
    
    /* Loading overlay */
    .loading-overlay {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.8);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1000;
      opacity: 0;
      visibility: hidden;
      transition: all var(--transition-speed) ease;
    }
    
    .loading-overlay.active {
      opacity: 1;
      visibility: visible;
    }
    
    .loading-spinner {
      width: 40px;
      height: 40px;
      border: 3px solid var(--border-primary);
      border-top: 3px solid transparent;
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }
    
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    
    /* Notification system */
    .notification {
      position: fixed;
      top: 20px;
      right: 20px;
      background: var(--bg-tertiary);
      color: var(--text-primary);
      padding: 0.75rem 1rem;
      border: 1px solid var(--border-primary);
      border-radius: 4px;
      z-index: 1001;
      transform: translateX(100%);
      transition: transform var(--transition-speed) ease;
    }
    
    .notification.show {
      transform: translateX(0);
    }

    /* Themes Panel Styles */
    #themes-panel {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.8);
      backdrop-filter: blur(5px);
      z-index: 2000;
      display: flex;
      align-items: center;
      justify-content: center;
      opacity: 0;
      visibility: hidden;
      transition: all var(--transition-speed) ease;
    }
    
    #themes-panel.active {
      opacity: 1;
      visibility: visible;
    }
    
    .themes-modal {
      background: var(--bg-secondary);
      border: 2px solid var(--border-primary);
      border-radius: 12px;
      padding: 2rem;
      max-width: 800px;
      width: 90%;
      max-height: 80vh;
      overflow-y: auto;
      transform: scale(0.8);
      transition: all var(--transition-speed) ease;
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.5);
    }
    
    #themes-panel.active .themes-modal {
      transform: scale(1);
    }
    
    .themes-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 2rem;
      padding-bottom: 1rem;
      border-bottom: 1px solid var(--border-primary);
    }
    
    .themes-title {
      font-size: 1.5rem;
      font-weight: bold;
      color: var(--text-primary);
    }
    
    .themes-close {
      background: none;
      border: none;
      font-size: 1.5rem;
      color: var(--text-primary);
      cursor: pointer;
      padding: 0.5rem;
      border-radius: 50%;
      transition: all var(--transition-speed) ease;
    }
    
    .themes-close:hover {
      background: var(--bg-accent);
      transform: scale(1.1);
    }
    
    .themes-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 1.5rem;
      margin-bottom: 2rem;
    }
    
    .theme-card {
      background: var(--bg-tertiary);
      border: 2px solid var(--border-primary);
      border-radius: 8px;
      padding: 1rem;
      cursor: pointer;
      transition: all var(--transition-speed) ease;
      position: relative;
      overflow: hidden;
    }
    
    .theme-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 16px var(--shadow-secondary);
      border-color: var(--accent-primary);
    }
    
    .theme-card.active {
      border-color: var(--accent-primary);
      box-shadow: 0 0 20px var(--shadow-primary);
    }
    
    .theme-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: linear-gradient(90deg, var(--accent-primary), var(--accent-secondary));
    }
    
    .theme-name {
      font-size: 1.1rem;
      font-weight: bold;
      margin-bottom: 0.5rem;
      color: var(--text-primary);
    }
    
    .theme-description {
      font-size: 0.9rem;
      color: var(--text-secondary);
      margin-bottom: 1rem;
      line-height: 1.4;
    }
    
    .theme-preview {
      display: flex;
      gap: 0.5rem;
      margin-bottom: 1rem;
    }
    
    .theme-color {
      width: 20px;
      height: 20px;
      border-radius: 50%;
      border: 1px solid var(--border-primary);
      transition: all var(--transition-speed) ease;
    }
    
    .theme-color:hover {
      transform: scale(1.2);
    }
    
    .themes-footer {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding-top: 1rem;
      border-top: 1px solid var(--border-primary);
    }
    
    .themes-info {
      color: var(--text-secondary);
      font-size: 0.9rem;
    }
    
    .themes-actions {
      display: flex;
      gap: 1rem;
    }
    
    .theme-button {
      padding: 0.5rem 1rem;
      border: 1px solid var(--border-primary);
      background: var(--bg-tertiary);
      color: var(--text-primary);
      border-radius: 4px;
      cursor: pointer;
      transition: all var(--transition-speed) ease;
    }
    
    .theme-button:hover {
      background: var(--bg-accent);
      transform: translateY(-1px);
    }
    
    .theme-button.primary {
      background: var(--accent-primary);
      border-color: var(--accent-primary);
    }
    
    .theme-button.primary:hover {
      background: var(--accent-secondary);
    }
    
    /* Theme transition animation */
    body.theme-changing {
      animation: themeTransition 0.5s ease-out;
    }
    
    /* Custom scrollbar for themes panel */
    .themes-modal::-webkit-scrollbar {
      width: 8px;
    }
    
    .themes-modal::-webkit-scrollbar-track {
      background: var(--bg-tertiary);
    }
    
    .themes-modal::-webkit-scrollbar-thumb {
      background: var(--border-primary);
      border-radius: 4px;
    }
    
    .themes-modal::-webkit-scrollbar-thumb:hover {
      background: var(--accent-primary);
    }
  </style>
</head>
<body>
  <div id="tab-bar">
    <div id="new-tab">+</div>
  </div>
  
  <div id="controls">
    <button id="back-button"><</button>
    <button id="forward-button">></button>
    <button id="refresh-button">↻</button>
    <input id="urlInput" placeholder="Enter URL or search..." />
    <button id="go-button">Go</button>
    <button id="themes-button">🎨</button>
    <button id="toggle-devtools">{ }</button>
  </div>
  
  <div id="content">
    <div class="loading-overlay" id="loading-overlay">
      <div class="loading-spinner"></div>
    </div>
    <!-- Iframe containers will be added here dynamically -->
  </div>
  
  <div id="devtools">
    <div id="devtools-header">
      <div id="devtools-tabs">
        <div class="devtools-tab active" data-panel="console">Console</div>
        <div class="devtools-tab" data-panel="js-inject">JS Inject</div>
        <div class="devtools-tab" data-panel="network">Network</div>
      </div>
      <button id="close-devtools">×</button>
    </div>
    <div id="devtools-panels">
      <div class="devtools-panel active" id="console-panel">
        <div id="console-output"></div>
        <input id="console-input" placeholder="Enter JavaScript to execute in the active tab..." />
      </div>
      <div class="devtools-panel" id="js-inject-panel">
        <textarea id="js-inject-area" placeholder="Enter JavaScript code to inject into the active tab..."></textarea>
        <div class="action-buttons">
          <button id="inject-js-button">Inject JavaScript</button>
          <button id="clear-js-button" class="small-button">Clear</button>
          <button id="save-js-button" class="small-button">Save Snippet</button>
          <select id="saved-snippets">
            <option value="">-- Saved Snippets --</option>
            <option value="document.querySelectorAll('*').forEach(el => el.style.border = '1px solid red')">
              Highlight All Elements
            </option>
            <option value="console.log(document.cookie)">Log Cookies</option>
            <option value="document.body.style.filter = 'invert(100%)'">Invert Colors</option>
          </select>
        </div>
      </div>
      <div class="devtools-panel" id="network-panel">
        <div id="network-log">Network monitoring will appear here...</div>
        <div class="action-buttons">
          <button id="clear-network-log">Clear Log</button>
        </div>
      </div>
    </div>
  </div>
  
  <div class="status-bar">
    <span id="status-text">Ready</span>
    <span id="tab-count">Tabs: 1</span>
  </div>

  <!-- Themes Panel -->
  <div id="themes-panel">
    <div class="themes-modal">
      <div class="themes-header">
        <div class="themes-title">🎨 Theme Selection</div>
        <button class="themes-close" id="themes-close">×</button>
      </div>
      
      <div class="themes-grid" id="themes-grid">
        <!-- Theme cards will be generated here -->
      </div>
      
      <div class="themes-footer">
        <div class="themes-info">
          Choose a theme to customize your browsing experience
        </div>
        <div class="themes-actions">
          <button class="theme-button" id="reset-theme">Reset to Default</button>
          <button class="theme-button primary" id="apply-theme">Apply Theme</button>
        </div>
      </div>
    </div>
  </div>

  <script>
    // Theme definitions
    const themes = {
      purple: {
        name: "Purple Haze",
        description: "The classic purple theme with magenta accents",
        colors: {
          '--bg-primary': '#000',
          '--bg-secondary': '#1a001a',
          '--bg-tertiary': '#2a0033',
          '--bg-quaternary': '#3a0044',
          '--bg-accent': '#4a0055',
          '--text-primary': '#d0f',
          '--text-secondary': '#d0f9',
          '--border-primary': '#d0f',
          '--border-secondary': 'rgba(221, 0, 255, 0.3)',
          '--border-tertiary': '#d0f3',
          '--accent-primary': '#ff00ff',
          '--accent-secondary': '#d0f',
          '--shadow-primary': 'rgba(221, 0, 255, 0.5)',
          '--shadow-secondary': 'rgba(221, 0, 255, 0.3)',
          '--shadow-tertiary': 'rgba(221, 0, 255, 0.2)',
          '--error-color': '#f00',
          '--warning-color': '#ff0',
          '--info-color': '#0ff',
          '--success-color': '#0f0',
          '--transition-speed': '0.3s'
        },
        preview: ['#d0f', '#ff00ff', '#2a0033', '#4a0055', '#000']
      },
      
      cyberpunk: {
        name: "Cyberpunk 2077",
        description: "Neon-lit future with electric blues and pinks",
        colors: {
          '--bg-primary': '#0a0a0a',
          '--bg-secondary': '#1a1a2e',
          '--bg-tertiary': '#16213e',
          '--bg-quaternary': '#0f3460',
          '--bg-accent': '#533a7b',
          '--text-primary': '#00ffff',
          '--text-secondary': '#00ffff99',
          '--border-primary': '#00ffff',
          '--border-secondary': 'rgba(0, 255, 255, 0.3)',
          '--border-tertiary': '#00ffff33',
          '--accent-primary': '#ff0080',
          '--accent-secondary': '#00ffff',
          '--shadow-primary': 'rgba(0, 255, 255, 0.5)',
          '--shadow-secondary': 'rgba(255, 0, 128, 0.3)',
          '--shadow-tertiary': 'rgba(0, 255, 255, 0.2)',
          '--error-color': '#ff0040',
          '--warning-color': '#ffff00',
          '--info-color': '#00ffff',
          '--success-color': '#00ff80',
          '--transition-speed': '0.3s'
        },
        preview: ['#00ffff', '#ff0080', '#16213e', '#533a7b', '#0a0a0a']
      },
      
      matrix: {
        name: "Matrix Code",
        description: "Digital rain in the machine",
        colors: {
          '--bg-primary': '#000000',
          '--bg-secondary': '#001100',
          '--bg-tertiary': '#002200',
          '--bg-quaternary': '#003300',
          '--bg-accent': '#004400',
          '--text-primary': '#00ff00',
          '--text-secondary': '#00ff0099',
          '--border-primary': '#00ff00',
          '--border-secondary': 'rgba(0, 255, 0, 0.3)',
          '--border-tertiary': '#00ff0033',
          '--accent-primary': '#33ff33',
          '--accent-secondary': '#00ff00',
          '--shadow-primary': 'rgba(0, 255, 0, 0.5)',
          '--shadow-secondary': 'rgba(0, 255, 0, 0.3)',
          '--shadow-tertiary': 'rgba(0, 255, 0, 0.2)',
          '--error-color': '#ff0000',
          '--warning-color': '#ffff00',
          '--info-color': '#00ffff',
          '--success-color': '#00ff00',
          '--transition-speed': '0.3s'
        },
        preview: ['#00ff00', '#33ff33', '#002200', '#004400', '#000000']
      },
      
      sunset: {
        name: "Sunset Vibes",
        description: "Warm oranges and deep purples",
        colors: {
          '--bg-primary': '#1a0f1a',
          '--bg-secondary': '#2d1b2d',
          '--bg-tertiary': '#3d2a3d',
          '--bg-quaternary': '#4d3a4d',
          '--bg-accent': '#5d4a5d',
          '--text-primary': '#ff8c42',
          '--text-secondary': '#ff8c4299',
          '--border-primary': '#ff8c42',
          '--border-secondary': 'rgba(255, 140, 66, 0.3)',
          '--border-tertiary': '#ff8c4233',
          '--accent-primary': '#ff6b1a',
          '--accent-secondary': '#ff8c42',
          '--shadow-primary': 'rgba(255, 140, 66, 0.5)',
          '--shadow-secondary': 'rgba(255, 107, 26, 0.3)',
          '--shadow-tertiary': 'rgba(255, 140, 66, 0.2)',
          '--error-color': '#ff4444',
          '--warning-color': '#ffaa00',
          '--info-color': '#42a5f5',
          '--success-color': '#66bb6a',
          '--transition-speed': '0.3s'
        },
        preview: ['#ff8c42', '#ff6b1a', '#3d2a3d', '#5d4a5d', '#1a0f1a']
      },
      
      oceanic: {
        name: "Deep Ocean",
        description: "Mysterious depths with aqua highlights",
        colors: {
          '--bg-primary': '#0d1421',
          '--bg-secondary': '#1e2a3a',
          '--bg-tertiary': '#2d3f4f',
          '--bg-quaternary': '#3d5565',
          '--bg-accent': '#4d6a7a',
          '--text-primary': '#56c7d8',
          '--text-secondary': '#56c7d899',
          '--border-primary': '#56c7d8',
          '--border-secondary': 'rgba(86, 199, 216, 0.3)',
          '--border-tertiary': '#56c7d833',
          '--accent-primary': '#42b9d8',
          '--accent-secondary': '#56c7d8',
          '--shadow-primary': 'rgba(86, 199, 216, 0.5)',
          '--shadow-secondary': 'rgba(66, 185, 216, 0.3)',
          '--shadow-tertiary': 'rgba(86, 199, 216, 0.2)',
          '--error-color': '#ff5555',
          '--warning-color': '#ffb347',
          '--info-color': '#56c7d8',
          '--success-color': '#5cb85c',
          '--transition-speed': '0.3s'
        },
        preview: ['#56c7d8', '#42b9d8', '#2d3f4f', '#4d6a7a', '#0d1421']
      },
      
      forest: {
        name: "Forest Night",
        description: "Natural greens with earthy browns",
        colors: {
          '--bg-primary': '#1a2f1a',
          '--bg-secondary': '#2a3f2a',
          '--bg-tertiary': '#3a4f3a',
          '--bg-quaternary': '#4a5f4a',
          '--bg-accent': '#5a6f5a',
          '--text-primary': '#7fd662',
          '--text-secondary': '#7fd66299',
          '--border-primary': '#7fd662',
          '--border-secondary': 'rgba(127, 214, 98, 0.3)',
          '--border-tertiary': '#7fd66233',
          '--accent-primary': '#6bc442',
          '--accent-secondary': '#7fd662',
          '--shadow-primary': 'rgba(127, 214, 98, 0.5)',
          '--shadow-secondary': 'rgba(107, 196, 66, 0.3)',
          '--shadow-tertiary': 'rgba(127, 214, 98, 0.2)',
          '--error-color': '#e74c3c',
          '--warning-color': '#f39c12',
          '--info-color': '#3498db',
          '--success-color': '#27ae60',
          '--transition-speed': '0.3s'
        },
        preview: ['#7fd662', '#6bc442', '#3a4f3a', '#5a6f5a', '#1a2f1a']
      },
      
      midnight: {
        name: "Midnight Blue",
        description: "Cool midnight tones with silver accents",
        colors: {
          '--bg-primary': '#0f1419',
          '--bg-secondary': '#1f2428',
          '--bg-tertiary': '#2f3438',
          '--bg-quaternary': '#3f4448',
          '--bg-accent': '#4f5458',
          '--text-primary': '#c5c8c6',
          '--text-secondary': '#c5c8c699',
          '--border-primary': '#c5c8c6',
          '--border-secondary': 'rgba(197, 200, 198, 0.3)',
          '--border-tertiary': '#c5c8c633',
          '--accent-primary': '#81a2be',
          '--accent-secondary': '#c5c8c6',
          '--shadow-primary': 'rgba(129, 162, 190, 0.5)',
          '--shadow-secondary': 'rgba(129, 162, 190, 0.3)',
          '--shadow-tertiary': 'rgba(129, 162, 190, 0.2)',
          '--error-color': '#cc6666',
          '--warning-color': '#f0c674',
          '--info-color': '#81a2be',
          '--success-color': '#b5bd68',
          '--transition-speed': '0.3s'
        },
        preview: ['#c5c8c6', '#81a2be', '#2f3438', '#4f5458', '#0f1419']
      },
      
      neon: {
        name: "Neon Nights",
        description: "Electric neon with dark contrasts",
        colors: {
          '--bg-primary': '#000000',
          '--bg-secondary': '#111111',
          '--bg-tertiary': '#222222',
          '--bg-quaternary': '#333333',
          '--bg-accent': '#444444',
          '--text-primary': '#ff073a',
          '--text-secondary': '#ff073a99',
          '--border-primary': '#ff073a',
          '--border-secondary': 'rgba(255, 7, 58, 0.3)',
          '--border-tertiary': '#ff073a33',
          '--accent-primary': '#39ff14',
          '--accent-secondary': '#ff073a',
          '--shadow-primary': 'rgba(255, 7, 58, 0.5)',
          '--shadow-secondary': 'rgba(57, 255, 20, 0.3)',
          '--shadow-tertiary': 'rgba(255, 7, 58, 0.2)',
          '--error-color': '#ff073a',
          '--warning-color': '#ffff00',
          '--info-color': '#00ffff',
          '--success-color': '#39ff14',
          '--transition-speed': '0.3s'
        },
        preview: ['#ff073a', '#39ff14', '#222222', '#444444', '#000000']
      }
    };

    let currentTheme = 'purple';
    let selectedTheme = 'purple';

    const proxyBase = "https://api.allorigins.win/raw?url=";
    const tabs = [];
    let activeTabId = null;
    let tabCounter = 0;
    
    // Theme functions
    function loadTheme() {
      const savedTheme = localStorage.getItem('procksiTheme');
      if (savedTheme && themes[savedTheme]) {
        currentTheme = savedTheme;
        selectedTheme = savedTheme;
        applyTheme(savedTheme);
      }
    }
    
    function applyTheme(themeId) {
      const theme = themes[themeId];
      if (!theme) return;
      
      // Add theme changing animation
      document.body.classList.add('theme-changing');
      
      // Apply CSS variables
      const root = document.documentElement;
      Object.entries(theme.colors).forEach(([property, value]) => {
        root.style.setProperty(property, value);
      });
      
      // Update title
      document.title = `procksi (${theme.name})`;
      
      // Save to localStorage
      localStorage.setItem('procksiTheme', themeId);
      currentTheme = themeId;
      
      // Remove animation class
      setTimeout(() => {
        document.body.classList.remove('theme-changing');
      }, 500);
      
      showNotification(`Theme changed to ${theme.name}`);
    }
    
    function generateThemeCards() {
      const grid = document.getElementById('themes-grid');
      grid.innerHTML = '';
      
      Object.entries(themes).forEach(([id, theme]) => {
        const card = document.createElement('div');
        card.className = 'theme-card';
        card.dataset.themeId = id;
        
        if (id === currentTheme) {
          card.classList.add('active');
        }
        
        card.innerHTML = `
          <div class="theme-name">${theme.name}</div>
          <div class="theme-description">${theme.description}</div>
          <div class="theme-preview">
            ${theme.preview.map(color => `<div class="theme-color" style="background-color: ${color}"></div>`).join('')}
          </div>
        `;
        
        card.addEventListener('click', () => {
          // Remove active class from all cards
          document.querySelectorAll('.theme-card').forEach(c => c.classList.remove('active'));
          
          // Add active class to clicked card
          card.classList.add('active');
          selectedTheme = id;
          
          // Preview the theme
          previewTheme(id);
        });
        
        grid.appendChild(card);
      });
    }
    
    function previewTheme(themeId) {
      const theme = themes[themeId];
      if (!theme) return;
      
      // Apply theme temporarily for preview
      const root = document.documentElement;
      Object.entries(theme.colors).forEach(([property, value]) => {
        root.style.setProperty(property, value);
      });
    }
    
    function openThemesPanel() {
      generateThemeCards();
      document.getElementById('themes-panel').classList.add('active');
      selectedTheme = currentTheme;
    }
    
    function closeThemesPanel() {
      document.getElementById('themes-panel').classList.remove('active');
      
      // Restore current theme if user didn't apply
      if (selectedTheme !== currentTheme) {
        applyTheme(currentTheme);
      }
    }
    
    function resetTheme() {
      selectedTheme = 'purple';
      applyTheme('purple');
      
      // Update active card
      document.querySelectorAll('.theme-card').forEach(c => c.classList.remove('active'));
      document.querySelector('.theme-card[data-theme-id="purple"]').classList.add('active');
    }
    
    function applySelectedTheme() {
      if (selectedTheme !== currentTheme) {
        applyTheme(selectedTheme);
      }
      closeThemesPanel();
    }
    
    // Animation helper functions
    function showLoadingOverlay() {
      document.getElementById('loading-overlay').classList.add('active');
    }
    
    function hideLoadingOverlay() {
      document.getElementById('loading-overlay').classList.remove('active');
    }
    
    function showNotification(message, duration = 3000) {
      const notification = document.createElement('div');
      notification.className = 'notification';
      notification.textContent = message;
      document.body.appendChild(notification);
      
      setTimeout(() => notification.classList.add('show'), 100);
      setTimeout(() => {
        notification.classList.remove('show');
        setTimeout(() => notification.remove(), 300);
      }, duration);
    }
    
    function addStatusAnimation() {
      const statusText = document.getElementById('status-text');
      statusText.classList.add('status-updating');
      setTimeout(() => statusText.classList.remove('status-updating'), 1000);
    }
    
    // Initialize the browser with one tab
    document.addEventListener('DOMContentLoaded', () => {
      // Load saved theme
      loadTheme();
      
      createNewTab();
      
      // Set up event listeners
      document.getElementById('new-tab').addEventListener('click', () => createNewTab());
      document.getElementById('go-button').addEventListener('click', loadPageInActiveTab);
      document.getElementById('toggle-devtools').addEventListener('click', toggleDevTools);
      document.getElementById('close-devtools').addEventListener('click', closeDevTools);
      document.getElementById('console-input').addEventListener('keydown', handleConsoleInput);
      document.getElementById('inject-js-button').addEventListener('click', injectJavaScript);
      document.getElementById('clear-js-button').addEventListener('click', () => {
        document.getElementById('js-inject-area').value = '';
        showNotification('JavaScript area cleared');
      });
      document.getElementById('save-js-button').addEventListener('click', saveJavaScriptSnippet);
      document.getElementById('saved-snippets').addEventListener('change', loadSavedSnippet);
      document.getElementById('clear-network-log').addEventListener('click', () => {
        document.getElementById('network-log').innerHTML = 'Network log cleared...';
        showNotification('Network log cleared');
      });
      document.getElementById('back-button').addEventListener('click', navigateBack);
      document.getElementById('forward-button').addEventListener('click', navigateForward);
      document.getElementById('refresh-button').addEventListener('click', refreshPage);
      
      // Themes panel event listeners
      document.getElementById('themes-button').addEventListener('click', openThemesPanel);
      document.getElementById('themes-close').addEventListener('click', closeThemesPanel);
      document.getElementById('reset-theme').addEventListener('click', resetTheme);
      document.getElementById('apply-theme').addEventListener('click', applySelectedTheme);
      
      // Close themes panel on backdrop click
      document.getElementById('themes-panel').addEventListener('click', (e) => {
        if (e.target.id === 'themes-panel') {
          closeThemesPanel();
        }
      });
      
      // Escape key to close themes panel
      document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape' && document.getElementById('themes-panel').classList.contains('active')) {
          closeThemesPanel();
        }
      });
      
      // Set up devtools tabs
      document.querySelectorAll('.devtools-tab').forEach(tab => {
        tab.addEventListener('click', (e) => {
          document.querySelectorAll('.devtools-tab').forEach(t => t.classList.remove('active'));
          document.querySelectorAll('.devtools-panel').forEach(p => p.classList.remove('active'));
          
          e.target.classList.add('active');
          const panelId = e.target.dataset.panel;
          document.getElementById(`${panelId}-panel`).classList.add('active');
        });
      });
      
      // Load saved snippets from localStorage
      loadSavedSnippetsFromStorage();
    });
    
         function createNewTab(url = null) {
      const tabId = `tab-${tabCounter++}`;
      
      // Create tab button
      const tabElement = document.createElement('div');
      tabElement.className = 'tab new';
      tabElement.dataset.tabId = tabId;
      tabElement.innerHTML = `
        <span class="tab-title">New Tab</span>
        <span class="tab-close">×</span>
      `;
      tabElement.addEventListener('click', (e) => {
        if (!e.target.classList.contains('tab-close')) {
          activateTab(tabId);
        }
      });
      
      // Add close button functionality
      const closeButton = tabElement.querySelector('.tab-close');
      closeButton.addEventListener('click', (e) => {
        e.stopPropagation();
        closeTab(tabId);
      });
      
      // Insert tab before the new tab button
      document.getElementById('tab-bar').insertBefore(tabElement, document.getElementById('new-tab'));
      
      // Remove 'new' class after animation completes
      setTimeout(() => {
        tabElement.classList.remove('new');
      }, 300);
      
      // Create iframe container
      const iframeContainer = document.createElement('div');
      iframeContainer.className = 'iframe-container';
      iframeContainer.id = `container-${tabId}`;
      
      const iframe = document.createElement('iframe');
      iframe.id = `iframe-${tabId}`;
      iframe.sandbox = "allow-scripts allow-forms allow-same-origin";
      iframe.srcdoc = `
        <!DOCTYPE html>
        <html>
        <head>
          <style>
            * {
              margin: 0;
              padding: 0;
              box-sizing: border-box;
            }
            html, body {
              width: 100%;
              height: 100%;
              overflow: hidden;
            }
            .newtab-iframe {
              width: 100vw;
              height: 100vh;
              border: none;
              margin: 0;
              padding: 0;
              display: block;
            }
          </style>
        </head>
        <body>
          <scr` + `ipt>
            const htmlUrl = "https://cdn.jsdelivr.net/gh/DominumNetwork/DominumSiteFiles@latest/home.html";
            
            fetch(htmlUrl)
              .then(res => res.text())
              .then(html => {
                const blob = new Blob([html], { type: 'text/html' });
                const url = URL.createObjectURL(blob);
                
                const iframe = document.createElement('iframe');
                iframe.src = url;
                iframe.className = 'newtab-iframe';
                document.body.appendChild(iframe);
              })
              .catch(err => {
                document.body.innerHTML = '<div style="padding: 20px; color: var(--text-primary); font-family: monospace;">Error loading new tab page: ' + err.message + '</div>';
              });
          </scr` + `ipt>
        </body>
        </html>
      `;
      
      iframeContainer.appendChild(iframe);
      document.getElementById('content').appendChild(iframeContainer);
      
      // Add to tabs array
      tabs.push({
        id: tabId,
        title: 'New Tab',
        url: '',
        history: [],
        currentHistoryIndex: -1
      });
      
      // Activate the new tab
      activateTab(tabId);
      
      // If URL is provided, load it
      if (url) {
        document.getElementById('urlInput').value = url;
        loadPageInActiveTab();
      }
      
      updateTabCount();
      showNotification('New tab created');
    }
    
    function activateTab(tabId) {
      // Deactivate all tabs
      document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
      document.querySelectorAll('.iframe-container').forEach(container => {
        container.classList.remove('active');
      });
      
      // Activate selected tab with animation
      const selectedTab = document.querySelector(`.tab[data-tab-id="${tabId}"]`);
      const selectedContainer = document.getElementById(`container-${tabId}`);
      
      selectedTab.classList.add('active');
      selectedContainer.classList.add('active');
      
      // Update active tab ID
      activeTabId = tabId;
      
      // Update URL input with the active tab's URL
      const tab = tabs.find(t => t.id === tabId);
      if (tab && tab.url) {
        document.getElementById('urlInput').value = tab.url;
      } else {
        document.getElementById('urlInput').value = '';
      }
      
      updateNavigationButtons();
    }
    
    function closeTab(tabId) {
      // Don't close if it's the last tab
      if (tabs.length <= 1) {
        showNotification('Cannot close the last tab');
        return;
      }
      
      const tabElement = document.querySelector(`.tab[data-tab-id="${tabId}"]`);
      const container = document.getElementById(`container-${tabId}`);
      
      // Add closing animation
      tabElement.classList.add('closing');
      
      // Remove elements after animation
      setTimeout(() => {
        tabElement.remove();
        container.remove();
        
        // Remove from tabs array
        const tabIndex = tabs.findIndex(t => t.id === tabId);
        tabs.splice(tabIndex, 1);
        
        // If closing the active tab, activate another one
        if (activeTabId === tabId) {
          // Activate the tab to the left, or the first tab if there's none
          const newActiveTab = tabs[Math.max(0, tabIndex - 1)];
          activateTab(newActiveTab.id);
        }
        
        updateTabCount();
        showNotification('Tab closed');
      }, 300);
    }
    
    function updateTabTitle(tabId, title) {
      const tab = tabs.find(t => t.id === tabId);
      if (tab) {
        tab.title = title || 'Untitled';
        const tabElement = document.querySelector(`.tab[data-tab-id="${tabId}"] .tab-title`);
        tabElement.textContent = tab.title;
      }
    }
    
    function looksLikeUrl(str) {
      return /\./.test(str) && !/\s/.test(str);
    }

    function prepareUrl(inputStr) {
      inputStr = inputStr.trim();
      if (!inputStr) return null;

      if (looksLikeUrl(inputStr)) {
        if (!/^https?:\/\//i.test(inputStr)) {
          inputStr = "https://" + inputStr;
        }
        return inputStr;
      } else {
        const query = encodeURIComponent(inputStr);
        return `https://www.webcrawler.com/serp?q=${query}`;
      }
    }
    
    async function loadPageInActiveTab() {
      if (!activeTabId) return;
      
      const input = document.getElementById('urlInput');
      let rawInput = input.value.trim();
      if (!rawInput) {
        showNotification('Please enter a URL or search term');
        return;
      }
      
      const target = prepareUrl(rawInput);
      input.value = target;
      
      const tab = tabs.find(t => t.id === activeTabId);
      const iframe = document.getElementById(`iframe-${activeTabId}`);
      const container = document.getElementById(`container-${activeTabId}`);
      
      try {
        // Show loading state
        showLoadingOverlay();
        container.classList.add('loading');
        updateStatus(`Loading ${target}...`);
        addStatusAnimation();
        
        iframe.srcdoc = `<div style="display: flex; align-items: center; justify-content: center; height: 100vh; background: var(--bg-primary); color: var(--text-primary); font-family: monospace;">
          <div style="text-align: center;">
            <div style="width: 40px; height: 40px; border: 3px solid var(--border-primary); border-top: 3px solid transparent; border-radius: 50%; animation: spin 1s linear infinite; margin: 0 auto 1rem;"></div>
            <div>Loading ${target}...</div>
          </div>
          <style>
            @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
          </style>
        </div>`;
        
        const response = await fetch(proxyBase + encodeURIComponent(target));
        if (!response.ok) throw new Error("Failed to fetch");
        
        const html = await response.text();
        const modifiedHTML = injectProxyScript(html, target);
        
        iframe.srcdoc = modifiedHTML;
        
        // Update tab information
        tab.url = target;
        
        // Extract title from HTML
        const titleMatch = html.match(/<title[^>]*>(.*?)<\/title>/i);
        const pageTitle = titleMatch ? titleMatch[1] : target.replace(/^https?:\/\//i, '');
        updateTabTitle(activeTabId, pageTitle);
        
        // Add to history
        if (tab.currentHistoryIndex < tab.history.length - 1) {
          // If we navigated back and then to a new page, truncate the forward history
          tab.history = tab.history.slice(0, tab.currentHistoryIndex + 1);
        }
        tab.history.push(target);
        tab.currentHistoryIndex = tab.history.length - 1;
        
        updateNavigationButtons();
        updateStatus(`Loaded: ${target}`);
        addStatusAnimation();
        showNotification(`Page loaded: ${pageTitle}`);
        
      } catch (err) {
        iframe.srcdoc = `<pre style="padding:2rem; color:var(--error-color); font-family: monospace;">Error: ${err.message}</pre>`;
        updateStatus(`Error: ${err.message}`);
        addStatusAnimation();
        showNotification(`Error loading page: ${err.message}`);
      } finally {
        hideLoadingOverlay();
        container.classList.remove('loading');
      }
    }
    
    function injectProxyScript(html, baseUrl) {
      const baseTag = `<base href="${baseUrl}">`;
      const interceptScript = `
        <script>
          // Intercept link clicks
          document.addEventListener('click', e => {
            const a = e.target.closest('a[href]');
            if (a && a.href && a.target !== '_blank') {
              e.preventDefault();
              parent.postMessage({ type: 'navigate', href: a.href }, '*');
            }
          });
          
          // Intercept console methods
          const originalConsole = {
            log: console.log,
            error: console.error,
            warn: console.warn,
            info: console.info
          };
          
          console.log = function(...args) {
            originalConsole.log(...args);
            parent.postMessage({ 
              type: 'console', 
              method: 'log', 
              args: args.map(arg => String(arg))
            }, '*');
          };
          
          console.error = function(...args) {
            originalConsole.error(...args);
            parent.postMessage({ 
              type: 'console', 
              method: 'error', 
              args: args.map(arg => String(arg))
            }, '*');
          };
          
          console.warn = function(...args) {
            originalConsole.warn(...args);
            parent.postMessage({ 
              type: 'console', 
              method: 'warn', 
              args: args.map(arg => String(arg))
            }, '*');
          };
          
          console.info = function(...args) {
            originalConsole.info(...args);
            parent.postMessage({ 
              type: 'console', 
              method: 'info', 
              args: args.map(arg => String(arg))
            }, '*');
          };
          
          // Intercept fetch requests for network panel
          const originalFetch = window.fetch;
          window.fetch = function(resource, init) {
            const url = typeof resource === 'string' ? resource : resource.url;
            parent.postMessage({ 
              type: 'network', 
              method: init?.method || 'GET',
              url: url
            }, '*');
            return originalFetch.apply(this, arguments);
          };
          
          // Intercept XHR for network panel
          const originalXHROpen = XMLHttpRequest.prototype.open;
          XMLHttpRequest.prototype.open = function(method, url) {
            this._method = method;
            this._url = url;
            return originalXHROpen.apply(this, arguments);
          };
          
          const originalXHRSend = XMLHttpRequest.prototype.send;
          XMLHttpRequest.prototype.send = function() {
            parent.postMessage({ 
              type: 'network', 
              method: this._method,
              url: this._url
            }, '*');
            return originalXHRSend.apply(this, arguments);
          };
        <\/script>
      `;
      
      const styleOverride = `
        <style>
          /* Optional: Add any style overrides here */
        </style>
      `;
      
      if (/<head[^>]*>/i.test(html)) {
        return html.replace(/<head[^>]*>/i, match => match + baseTag + interceptScript + styleOverride);
      } else {
        return baseTag + interceptScript + styleOverride + html;
      }
    }
    
    function toggleDevTools() {
      const devtools = document.getElementById('devtools');
      const isOpen = devtools.classList.contains('open');
      
      if (isOpen) {
        devtools.classList.add('closing');
        setTimeout(() => {
          devtools.classList.remove('open', 'closing');
        }, 400);
        showNotification('Developer tools closed');
      } else {
        devtools.classList.add('opening');
        devtools.classList.add('open');
        setTimeout(() => {
          devtools.classList.remove('opening');
        }, 400);
        showNotification('Developer tools opened');
      }
    }
    
    function closeDevTools() {
      const devtools = document.getElementById('devtools');
      devtools.classList.add('closing');
      setTimeout(() => {
        devtools.classList.remove('open', 'closing');
      }, 400);
      showNotification('Developer tools closed');
    }
    
    function handleConsoleInput(e) {
      if (e.key === 'Enter') {
        const input = document.getElementById('console-input');
        const code = input.value;
        
        if (!code.trim()) return;
        
        // Log the input to the console output
        appendToConsole('log', `> ${code}`);
        
        // Execute in the active iframe
        executeInActiveTab(code);
        
        // Clear the input
        input.value = '';
      }
    }
    
    function executeInActiveTab(code) {
      if (!activeTabId) return;
      
      const iframe = document.getElementById(`iframe-${activeTabId}`);
      try {
        // Execute the code in the iframe and get the result
        const result = iframe.contentWindow.eval(`
          try {
            const result = eval(${JSON.stringify(code)});
            if (result !== undefined) {
              console.log(result);
            }
            "SUCCESS";
          } catch (e) {
            console.error(e.message);
            "ERROR: " + e.message;
          }
        `);
        
        if (result && result.startsWith && result.startsWith('ERROR:')) {
          appendToConsole('error', result);
        }
      } catch (e) {
        appendToConsole('error', `Failed to execute: ${e.message}`);
      }
    }
    
    function injectJavaScript() {
      const code = document.getElementById('js-inject-area').value;
      if (!code.trim()) {
        showNotification('Please enter JavaScript code to inject');
        return;
      }
      
      executeInActiveTab(code);
      updateStatus('JavaScript injected');
      addStatusAnimation();
      showNotification('JavaScript code injected');
    }
    
    function appendToConsole(type, message) {
      const consoleOutput = document.getElementById('console-output');
      const line = document.createElement('div');
      line.className = `console-line console-${type}`;
      line.textContent = message;
      consoleOutput.appendChild(line);
      consoleOutput.scrollTop = consoleOutput.scrollHeight;
    }
    
    function saveJavaScriptSnippet() {
      const code = document.getElementById('js-inject-area').value;
      if (!code.trim()) {
        showNotification('Please enter JavaScript code to save');
        return;
      }
      
      const snippetName = prompt('Enter a name for this snippet:');
      if (!snippetName) return;
      
      // Get existing snippets
      let savedSnippets = JSON.parse(localStorage.getItem('procksiSnippets') || '{}');
      savedSnippets[snippetName] = code;
      
      // Save back to localStorage
      localStorage.setItem('procksiSnippets', JSON.stringify(savedSnippets));
      
      // Update the dropdown
      loadSavedSnippetsFromStorage();
      updateStatus(`Snippet "${snippetName}" saved`);
      addStatusAnimation();
      showNotification(`Snippet "${snippetName}" saved`);
    }
    
    function loadSavedSnippetsFromStorage() {
      const savedSnippets = JSON.parse(localStorage.getItem('procksiSnippets') || '{}');
      const select = document.getElementById('saved-snippets');
      
      // Clear existing options except the first one
      while (select.options.length > 1) {
        select.remove(1);
      }
      
      // Add snippets from storage
      for (const [name, code] of Object.entries(savedSnippets)) {
        const option = document.createElement('option');
        option.value = code;
        option.textContent = name;
        select.appendChild(option);
      }
    }
    
    function loadSavedSnippet(e) {
      const code = e.target.value;
      if (code) {
        document.getElementById('js-inject-area').value = code;
        showNotification('Snippet loaded');
      }
      // Reset the select
      setTimeout(() => {
        e.target.selectedIndex = 0;
      }, 100);
    }
    
    function navigateBack() {
      if (!activeTabId) return;
      
      const tab = tabs.find(t => t.id === activeTabId);
      if (tab && tab.currentHistoryIndex > 0) {
        tab.currentHistoryIndex--;
        const url = tab.history[tab.currentHistoryIndex];
        document.getElementById('urlInput').value = url;
        loadPageInActiveTab();
        showNotification('Navigated back');
      }
    }
    
    function navigateForward() {
      if (!activeTabId) return;
      
      const tab = tabs.find(t => t.id === activeTabId);
      if (tab && tab.currentHistoryIndex < tab.history.length - 1) {
        tab.currentHistoryIndex++;
        const url = tab.history[tab.currentHistoryIndex];
        document.getElementById('urlInput').value = url;
        loadPageInActiveTab();
        showNotification('Navigated forward');
      }
    }
    
    function refreshPage() {
      if (!activeTabId) return;
      
      const tab = tabs.find(t => t.id === activeTabId);
      if (tab && tab.url) {
        document.getElementById('urlInput').value = tab.url;
        loadPageInActiveTab();
        showNotification('Page refreshed');
      }
    }
    
    function updateNavigationButtons() {
      if (!activeTabId) return;
      
      const tab = tabs.find(t => t.id === activeTabId);
      const backButton = document.getElementById('back-button');
      const forwardButton = document.getElementById('forward-button');
      
      backButton.disabled = !tab || tab.currentHistoryIndex <= 0;
      forwardButton.disabled = !tab || tab.currentHistoryIndex >= tab.history.length - 1;
    }
    
    function updateStatus(message) {
      document.getElementById('status-text').textContent = message;
    }
    
    function updateTabCount() {
      document.getElementById('tab-count').textContent = `Tabs: ${tabs.length}`;
    }
    
    // Handle messages from iframes
    window.addEventListener("message", e => {
      if (e.data?.type === "navigate" && e.data.href) {
        document.getElementById('urlInput').value = e.data.href;
        loadPageInActiveTab();
      } else if (e.data?.type === "console") {
        appendToConsole(e.data.method, e.data.args.join(' '));
      } else if (e.data?.type === "network") {
        const networkLog = document.getElementById('network-log');
        const entry = document.createElement('div');
        entry.className = 'console-line';
        entry.textContent = `${e.data.method}: ${e.data.url}`;
        networkLog.appendChild(entry);
        networkLog.scrollTop = networkLog.scrollHeight;
      }
    });
    
    // URL input event
    document.getElementById('urlInput').addEventListener("keydown", e => {
      if (e.key === "Enter") {
        loadPageInActiveTab();
      }
    });
  </script>
</body>
</html>